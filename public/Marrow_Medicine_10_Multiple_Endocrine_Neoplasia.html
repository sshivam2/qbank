<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>10_Multiple Endocrine Neoplasia - Marrow Medicine</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        .medical-quiz {
            font-family: Segoe UI, Tahoma, Geneva, Verdana, sans-serif;
        }
        
        .question-card {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        }
        
        .option-card {
            transition: all 0.3s ease;
            cursor: pointer;
            border: 2px solid transparent;
        }
        
        .option-card:hover {
            border-color: #3b82f6;
            transform: translateY(-2px);
        }
        
        .option-card.selected {
            background: #3b82f6;
            color: white;
            border-color: #1d4ed8;
        }
        
        .option-card.correct {
            background: #10b981;
            color: white;
            border-color: #059669;
        }
        
        .option-card.incorrect {
            background: #ef4444;
            color: white;
            border-color: #dc2626;
        }
        
        .progress-bar {
            background: linear-gradient(to right, #10b981, #059669);
            transition: width 0.3s;
        }
        
        .medical-image {
            max-width: 100%;
            max-height: 400px;
            height: auto;
            border-radius: 12px;
            margin: 20px auto;
            display: block;
        }
        
        .hidden {
            display: none !important;
        }

        .explanation-content {
            font-family: Segoe UI, Tahoma, Geneva, Verdana, sans-serif;
            font-size: 1.05rem;
            line-height: 1.7;
            color: #374151;
            text-align: left;
        }
        
        .explanation-content p {
            margin-bottom: 1rem;
            text-align: justify;
        }
        
        .explanation-content strong, .explanation-content b {
            font-weight: 600;
            color: #1f2937;
        }
        
        .explanation-content img {
            max-width: 100%;
            height: auto;
            margin: 1.5rem auto;
            display: block;
            border-radius: 8px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }
    </style>
</head>

<body class="bg-gradient-to-br from-blue-50 to-indigo-100 min-h-screen medical-quiz">
    <header class="bg-white shadow-xl p-6">
        <div class="container mx-auto flex justify-between items-center">
            <div>
                <h1 class="text-3xl font-bold text-gray-800">10_Multiple Endocrine Neoplasia</h1>
                <p class="text-gray-600 mt-2">Marrow ‚Ä¢ Medicine ‚Ä¢ Interactive Learning</p>
            </div>
            <div class="flex gap-2">
                <button class="bg-gray-500 text-white px-3 py-2 text-sm rounded-lg hover:bg-gray-600 transition" 
                        onclick="window.location.href='marrow_medicine.html'">
                    ‚Üê Topics
                </button>
                <button class="bg-purple-500 text-white px-3 py-2 text-sm rounded-lg hover:bg-purple-600 transition" 
                        onclick="window.location.href='marrow.html'">
                    üìö Marrow
                </button>
                <button class="bg-blue-500 text-white px-3 py-2 text-sm rounded-lg hover:bg-blue-600 transition" 
                        onclick="window.location.href='index.html'">
                    üè† Home
                </button>
            </div>
        </div>
    </header>

    <!-- Statistics Bar (Hidden in Test Mode) -->
    <div class="bg-white shadow-lg p-4" id="stats-bar">
        <div class="container mx-auto flex justify-center gap-8">
            <div class="text-center">
                <div class="text-2xl font-bold text-green-600" id="correct-stats">0</div>
                <div class="text-sm text-gray-600">Correct</div>
            </div>
            <div class="text-center">
                <div class="text-2xl font-bold text-red-600" id="incorrect-stats">0</div>
                <div class="text-sm text-gray-600">Incorrect</div>
            </div>
            <div class="text-center">
                <div class="text-2xl font-bold text-blue-600" id="accuracy-stats">0%</div>
                <div class="text-sm text-gray-600">Accuracy</div>
            </div>
            <div class="text-center">
                <div class="text-2xl font-bold text-purple-600" id="progress-stats">0/13</div>
                <div class="text-sm text-gray-600">Progress</div>
            </div>
        </div>
    </div>

    <!-- Quiz Section -->
    <section class="container mx-auto p-6" id="quiz-section">
        <div class="bg-white rounded-2xl shadow-xl p-8">
            <!-- Progress Bar -->
            <div class="w-full bg-gray-200 rounded-full h-4 mb-8">
                <div class="progress-bar h-4 rounded-full" id="progress-bar"></div>
            </div>

            <div class="flex justify-between items-center mb-8">
                <h2 class="text-2xl font-bold text-blue-700" id="question-number">Question 1 of 13</h2>
                <div class="text-sm text-gray-600" id="question-status">Click an option to answer</div>
            </div>

            <!-- Question Text -->
            <div class="mb-10">
                <div class="question-card text-white p-8 rounded-2xl mb-8" id="question-text"></div>
                
                <!-- Question Image -->
                <div class="text-center mb-8" id="question-images"></div>
                
                <!-- Options -->
                <div class="space-y-4" id="options"></div>
            </div>

            <!-- Answer Feedback Section (Normal Mode Only) -->
            <div class="hidden mb-8 p-6 rounded-2xl" id="feedback-section">
                <div class="text-center mb-4">
                    <div class="text-6xl mb-2" id="feedback-icon"></div>
                    <div class="text-2xl font-bold mb-2" id="feedback-message">Correct!</div>
                </div>
                
                <div class="grid md:grid-cols-2 gap-4 mb-4">
                    <div class="bg-white p-4 rounded-xl border">
                        <strong>Your Answer:</strong><br>
                        <span id="user-answer-display"></span>
                    </div>
                    <div class="bg-white p-4 rounded-xl border">
                        <strong>Correct Answer:</strong><br>
                        <span class="text-green-600" id="correct-answer-display"></span>
                    </div>
                </div>
                
                <div class="bg-blue-50 p-6 rounded-xl" id="explanation-section">
                    <strong class="text-lg text-blue-800">Explanation:</strong>
                    <div id="explanation-content" class="mt-3 explanation-content"></div>
                </div>
            </div>

            <!-- Navigation -->
            <div class="flex justify-between gap-4">
                <button class="bg-gray-400 text-white px-6 py-3 rounded-xl hover:bg-gray-500 transition" 
                        onclick="window.location.href='marrow_medicine.html'">
                    Back to Topics
                </button>
                
                <div class="flex gap-4">
                    <button class="bg-gray-400 text-white px-6 py-3 rounded-xl disabled" id="prev-btn">
                        Previous
                    </button>
                    <button class="bg-blue-500 text-white px-6 py-3 rounded-xl hidden" id="next-btn">
                        Next
                    </button>
                    <button class="bg-green-600 text-white px-6 py-3 rounded-xl font-bold hidden" id="finish-btn">
                        Finish Quiz
                    </button>
                </div>
            </div>
        </div>
    </section>

    <!-- Test Mode Final Results -->
    <section class="container mx-auto p-6 hidden" id="test-results">
        <div class="bg-white rounded-2xl shadow-xl p-8">
            <div class="text-center mb-8">
                <h2 class="text-4xl font-bold mb-4 text-blue-700">Test Complete! üéâ</h2>
                <div class="text-6xl mb-4" id="test-grade-icon">üéØ</div>
            </div>
            
            <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-8">
                <div class="bg-green-100 p-6 rounded-2xl text-center">
                    <div class="text-4xl font-bold text-green-600" id="test-final-correct">0</div>
                    <div class="font-semibold text-green-700">Correct Answers</div>
                </div>
                <div class="bg-red-100 p-6 rounded-2xl text-center">
                    <div class="text-4xl font-bold text-red-600" id="test-final-incorrect">0</div>
                    <div class="font-semibold text-red-700">Incorrect Answers</div>
                </div>
                <div class="bg-blue-100 p-6 rounded-2xl text-center">
                    <div class="text-4xl font-bold text-blue-600" id="test-final-accuracy">0%</div>
                    <div class="font-semibold text-blue-700">Final Accuracy</div>
                </div>
            </div>

            <!-- Detailed Review -->
            <div class="mb-8">
                <h3 class="text-2xl font-bold text-gray-800 mb-4">üìã Detailed Review</h3>
                <div id="test-review-details" class="space-y-4"></div>
            </div>
            
            <div class="flex justify-center gap-4">
                <button class="bg-purple-600 text-white px-8 py-3 rounded-xl font-bold hover:bg-purple-700 transition" 
                        onclick="window.location.href='marrow_medicine.html'">
                    Back to Topics
                </button>
                <button class="bg-blue-600 text-white px-8 py-3 rounded-xl font-bold hover:bg-blue-700 transition" 
                        onclick="window.location.reload()">
                    Retake Quiz
                </button>
            </div>
        </div>
    </section>

    <!-- Normal Mode Final Results -->
    <section class="container mx-auto p-6 hidden" id="final-results">
        <div class="bg-white rounded-2xl shadow-xl p-8">
            <div class="text-center mb-8">
                <h2 class="text-4xl font-bold mb-4 text-blue-700">Quiz Complete! üéâ</h2>
                <div class="text-6xl mb-4" id="final-grade-icon">üéØ</div>
            </div>
            
            <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-8">
                <div class="bg-green-100 p-6 rounded-2xl text-center">
                    <div class="text-4xl font-bold text-green-600" id="final-correct">0</div>
                    <div class="font-semibold text-green-700">Correct Answers</div>
                </div>
                <div class="bg-red-100 p-6 rounded-2xl text-center">
                    <div class="text-4xl font-bold text-red-600" id="final-incorrect">0</div>
                    <div class="font-semibold text-red-700">Incorrect Answers</div>
                </div>
                <div class="bg-blue-100 p-6 rounded-2xl text-center">
                    <div class="text-4xl font-bold text-blue-600" id="final-accuracy">0%</div>
                    <div class="font-semibold text-blue-700">Final Accuracy</div>
                </div>
            </div>
            
            <div class="flex justify-center gap-4">
                <button class="bg-purple-600 text-white px-8 py-3 rounded-xl font-bold hover:bg-purple-700 transition" 
                        onclick="window.location.href='marrow_medicine.html'">
                    Back to Topics
                </button>
                <button class="bg-blue-600 text-white px-8 py-3 rounded-xl font-bold hover:bg-blue-700 transition" 
                        onclick="window.location.reload()">
                    Retake Quiz
                </button>
            </div>
        </div>
    </section>

    <script>
        const questions = [
  {
    "id": 218,
    "text": "Q1. Multiple endocrine neoplasia (MEN) type 1 is also called as .",
    "options": [
      {
        "label": "A",
        "text": "Wermer&apos;s syndrome",
        "correct": true
      },
      {
        "label": "B",
        "text": "Sipple syndrome",
        "correct": false
      },
      {
        "label": "C",
        "text": "Weber&apos;s syndrome",
        "correct": false
      },
      {
        "label": "D",
        "text": "Werner syndrome",
        "correct": false
      }
    ],
    "imageData": null,
    "explanationHTML": "<div class=\"explanation\">MEN1 is also referred to as Wermer's syndrome.</div><div class=\"telegram-link\"><small><a href=\"http://t.me/Friendly_neighborhood_medico_bot\"> </a></small></div>",
    "subdeck": "10_Multiple Endocrine Neoplasia",
    "deck_id": 1755954606593,
    "correctAnswer": "A. Wermer&apos;s syndrome"
  },
  {
    "id": 219,
    "text": "Q2. Which of the following conditions is not observed in MEN1 syndrome?",
    "options": [
      {
        "label": "A",
        "text": "Posterior pituitary tumors",
        "correct": true
      },
      {
        "label": "B",
        "text": "Foregut carcinoid",
        "correct": false
      },
      {
        "label": "C",
        "text": "Parathyroid adenoma",
        "correct": false
      },
      {
        "label": "D",
        "text": "Angiofibroma",
        "correct": false
      }
    ],
    "imageData": null,
    "explanationHTML": "<div class=\"explanation\">Anterior pituitary tumours are associated with MEN1 syndrome, not posterior pituitary tumors.</div><div class=\"telegram-link\"><small><a href=\"http://t.me/Friendly_neighborhood_medico_bot\"> </a></small></div>",
    "subdeck": "10_Multiple Endocrine Neoplasia",
    "deck_id": 1755954606593,
    "correctAnswer": "A. Posterior pituitary tumors"
  },
  {
    "id": 220,
    "text": "Q3. 35-year-old man presented with abdominal pain, nausea, and diarrhea. He had a history of hyperparathyroidism and a transsphenoidal prolactinoma resection. Which of the following is the most common functional enteropancreatic tumor seen in this condition?",
    "options": [
      {
        "label": "A",
        "text": "Glucagonoma",
        "correct": false
      },
      {
        "label": "B",
        "text": "Insulinoma",
        "correct": false
      },
      {
        "label": "C",
        "text": "Gastrinoma",
        "correct": true
      },
      {
        "label": "D",
        "text": "VIPoma",
        "correct": false
      }
    ],
    "imageData": null,
    "explanationHTML": "<div class=\"explanation\">The given scenario is suggestive of MEN1 syndrome and gastrinoma is the most common functional enteropancreatic tumor in MEN1 / Wermer's syndrome. Enteropancreatic tumors in MEN1 syndrome are: * Non-functioning pancreatic tumors (most common overall) * Functioning pancreatic tumors : * Gastrinoma - 50% (most common among functioning pancreatic tumours) ¬¢ Insulinoma - 30% * Glucagonoma * VIPoma (least common)</div><div class=\"telegram-link\"><small><a href=\"http://t.me/Friendly_neighborhood_medico_bot\"> </a></small></div>",
    "subdeck": "10_Multiple Endocrine Neoplasia",
    "deck_id": 1755954606593,
    "correctAnswer": "C. Gastrinoma"
  },
  {
    "id": 221,
    "text": "Q4. Which of the following is the most common site of gastrinoma in MEN 1 syndrome?",
    "options": [
      {
        "label": "A",
        "text": "Jejunum",
        "correct": false
      },
      {
        "label": "B",
        "text": "Ileum 125",
        "correct": false
      },
      {
        "label": "C",
        "text": "Duodenum",
        "correct": true
      },
      {
        "label": "D",
        "text": "Stomach",
        "correct": false
      }
    ],
    "imageData": null,
    "explanationHTML": "<div class=\"explanation\">Most common site of gastrinoma in MEN 1 syndrome is the first and second part of duodenum. MEN 1 syndrome is characterized by the triad of tumors involving the parathyroids, pancreatic islets, and anterior pituitary. Gastrinoma is the most common pancreatic islet tumor in MEN 1 syndrome and if it is associated with marked gastric acid production and recurrent peptic ulcers, the condition is called Zollinger Ellison syndrome.</div><div class=\"telegram-link\"><small><a href=\"http://t.me/Friendly_neighborhood_medico_bot\"> </a></small></div>",
    "subdeck": "10_Multiple Endocrine Neoplasia",
    "deck_id": 1755954606593,
    "correctAnswer": "C. Duodenum"
  },
  {
    "id": 222,
    "text": "Q5. 30-year-old man presents to the OPD with complaints of recurrent episodes of weakness, headache, sweating, and fainting after fasting. He tells that the symptoms improve after the consumption of food. There is a history of MEN1 syndrome running in the family. Serum C peptide levels are found to be elevated. What is the definitive treatment of choice in this patient?",
    "options": [
      {
        "label": "A",
        "text": "Frequent consumption carbohydrate-rich meals",
        "correct": false
      },
      {
        "label": "B",
        "text": "Octreotide",
        "correct": false
      },
      {
        "label": "C",
        "text": "Diazoxide",
        "correct": false
      },
      {
        "label": "D",
        "text": "Surgery",
        "correct": true
      }
    ],
    "imageData": null,
    "explanationHTML": "<div class=\"explanation\">129 The given clinical scenario along with elevated serum C peptide levels points towards a diagnosis of insulinoma in a MEN1 patient. The definitive treatment of choice in this patient is surgery. Insulinoma is the second most common functioning enteropancreatic tumor in MEN1 syndrome. Investigation of choice is 72-hour fasting glucose and serum insulin levels. These parameters are measured when the patient develops hypoglycemic symptoms during a supervised 72-hour fasting period. The treatment of choice is surgery, ranging from enucleation of a single tumor to pancreatectomy. Non-surgical management of insulinoma includes frequent consumption of carbohydrate-rich meals, octreotide or diazoxide, which are not always successful. Selpercatinib, a kinase inhibitor was recently approved by the FDA. It is used to treat tumours with a mutation in the RET gene. These are non-small cell lung cancer, medullary thyroid cancer, and other types of thyroid cancers in patients with a mutation in the RET gene.</div><div class=\"telegram-link\"><small><a href=\"http://t.me/Friendly_neighborhood_medico_bot\"> </a></small></div>",
    "subdeck": "10_Multiple Endocrine Neoplasia",
    "deck_id": 1755954606593,
    "correctAnswer": "D. Surgery"
  },
  {
    "id": 223,
    "text": "Q6. Which of the following is the most frequently observed cutaneous manifestation of MEN1 syndrome?",
    "options": [
      {
        "label": "A",
        "text": "Lipoma",
        "correct": false
      },
      {
        "label": "B",
        "text": "Angiofibroma",
        "correct": true
      },
      {
        "label": "C",
        "text": "Collagenoma",
        "correct": false
      },
      {
        "label": "D",
        "text": "Neurofibroma",
        "correct": false
      }
    ],
    "imageData": null,
    "explanationHTML": "<div class=\"explanation\">The most frequently observed cutaneous manifestation of MEN1 syndrome is angiofibroma. Cutaneous tumors in MEN1 Syndrome are: * Angiofibroma ‚Äî 85% * Collagenoma ‚Äî 70% * Lipoma - 33%</div><div class=\"telegram-link\"><small><a href=\"http://t.me/Friendly_neighborhood_medico_bot\"> </a></small></div>",
    "subdeck": "10_Multiple Endocrine Neoplasia",
    "deck_id": 1755954606593,
    "correctAnswer": "B. Angiofibroma"
  },
  {
    "id": 224,
    "text": "Q7. 22-year-old man who was diagnosed with MENi syndrome presents to your OPD for his annual checkup. Which of the following investigations will you not do as part of annual screening for this patient?",
    "options": [
      {
        "label": "A",
        "text": "Fasting glucose levels",
        "correct": false
      },
      {
        "label": "B",
        "text": "Serum calcium levels",
        "correct": false
      },
      {
        "label": "C",
        "text": "Secretin study",
        "correct": true
      },
      {
        "label": "D",
        "text": "Serum gastrin levels 126",
        "correct": false
      }
    ],
    "imageData": null,
    "explanationHTML": "<div class=\"explanation\">Secretin study is not done as an annual screening test in patients with MEN1 syndrome. It is a provocative test for the diagnosis of gastrinoma. Annual biochemical screening tests to be done in patients with MEN1 syndrome are: Other imaging tests like MRI and CT might have to be done for screening of conditions like anterior pituitary tumors or adrenal tumors. Parathyroid = 8S Calcium, PTH Other pancreatic NE | &lt;10 Chromogranin A; pancreatic Ts polypeptide, glucagon,vasoac tive intestinal peptide 130</div><div class=\"telegram-link\"><small><a href=\"http://t.me/Friendly_neighborhood_medico_bot\"> </a></small></div>",
    "subdeck": "10_Multiple Endocrine Neoplasia",
    "deck_id": 1755954606593,
    "correctAnswer": "C. Secretin study"
  },
  {
    "id": 225,
    "text": "Q8. What is the most common component of Sipple‚Äôs syndrome?",
    "options": [
      {
        "label": "A",
        "text": "Medullary thyroid cancer",
        "correct": true
      },
      {
        "label": "B",
        "text": "Hyperparathyroidism",
        "correct": false
      },
      {
        "label": "C",
        "text": "Pituitary adenoma",
        "correct": false
      },
      {
        "label": "D",
        "text": "Gastrinoma",
        "correct": false
      }
    ],
    "imageData": null,
    "explanationHTML": "<div class=\"explanation\">The most common component of MEN2A syndrome, which is also called Sipple‚Äôs syndrome is medullary thyroid cancer.</div><div class=\"telegram-link\"><small><a href=\"http://t.me/Friendly_neighborhood_medico_bot\"> </a></small></div>",
    "subdeck": "10_Multiple Endocrine Neoplasia",
    "deck_id": 1755954606593,
    "correctAnswer": "A. Medullary thyroid cancer"
  },
  {
    "id": 226,
    "text": "Q9. Which of the following features would you not expect to see in a patient with MEN2 syndrome?",
    "options": [
      {
        "label": "A",
        "text": "Pituitary adenoma",
        "correct": true
      },
      {
        "label": "B",
        "text": "Parathyroid adenoma",
        "correct": false
      },
      {
        "label": "C",
        "text": "Medullary thyroid cancer",
        "correct": false
      },
      {
        "label": "D",
        "text": "Pheochromocytoma",
        "correct": false
      }
    ],
    "imageData": null,
    "explanationHTML": "<div class=\"explanation\">Pituitary adenoma is not a characteristic feature of the symptom complex of MEN2 and its variants, but it is observed in MEN1 and MEN4 syndrome.</div><div class=\"telegram-link\"><small><a href=\"http://t.me/Friendly_neighborhood_medico_bot\"> </a></small></div>",
    "subdeck": "10_Multiple Endocrine Neoplasia",
    "deck_id": 1755954606593,
    "correctAnswer": "A. Pituitary adenoma"
  },
  {
    "id": 227,
    "text": "Q10. Which of the following features would you not expect to see in a patient with MEN2B syndrome?",
    "options": [
      {
        "label": "A",
        "text": "Mucosal neuromas",
        "correct": false
      },
      {
        "label": "B",
        "text": "Marfanoid habitus",
        "correct": false
      },
      {
        "label": "C",
        "text": "Medullated corneal nerve fibers",
        "correct": false
      },
      {
        "label": "D",
        "text": "Meningioma",
        "correct": true
      }
    ],
    "imageData": null,
    "explanationHTML": "<div class=\"explanation\">Meningioma is not commonly seen in MEN2B Syndrome. MEN1 syndrome is associated with meningiomas.</div><div class=\"telegram-link\"><small><a href=\"http://t.me/Friendly_neighborhood_medico_bot\"> </a></small></div>",
    "subdeck": "10_Multiple Endocrine Neoplasia",
    "deck_id": 1755954606593,
    "correctAnswer": "D. Meningioma"
  },
  {
    "id": 228,
    "text": "Q11. MEN4 syndrome is caused by a mutation in which of the following genes?",
    "options": [
      {
        "label": "A",
        "text": "PPKARiA",
        "correct": false
      },
      {
        "label": "B",
        "text": "RET proto-oncogene",
        "correct": false
      },
      {
        "label": "C",
        "text": "PRKARiB",
        "correct": false
      },
      {
        "label": "D",
        "text": "CDKN1B 127",
        "correct": true
      }
    ],
    "imageData": null,
    "explanationHTML": "<div class=\"explanation\">MEN4 is caused by genetic mutations in CDKN1B (cyclin-dependent kinase inhibitor), located on chromosome 12. MEN1 is caused due to MEN1 gene mutation on chromosome 11. MEN? is associated with RET proto-oncogene mutation on chromosome 10.</div><div class=\"telegram-link\"><small><a href=\"http://t.me/Friendly_neighborhood_medico_bot\"> </a></small></div>",
    "subdeck": "10_Multiple Endocrine Neoplasia",
    "deck_id": 1755954606593,
    "correctAnswer": "D. CDKN1B 127"
  },
  {
    "id": 229,
    "text": "Q12. Which of the following malignancies would you not expect to see in a patient with MEN4 syndrome?",
    "options": [
      {
        "label": "A",
        "text": "Pituitary adenoma",
        "correct": false
      },
      {
        "label": "B",
        "text": "Parathyroid adenoma",
        "correct": false
      },
      {
        "label": "C",
        "text": "Medullary thyroid carcinoma",
        "correct": true
      },
      {
        "label": "D",
        "text": "Renal tumors",
        "correct": false
      }
    ],
    "imageData": null,
    "explanationHTML": "<div class=\"explanation\">Medullary thyroid carcinoma is not associated with MEN4 syndrome, but it is associated with MEN2 syndrome.</div><div class=\"telegram-link\"><small><a href=\"http://t.me/Friendly_neighborhood_medico_bot\"> </a></small></div>",
    "subdeck": "10_Multiple Endocrine Neoplasia",
    "deck_id": 1755954606593,
    "correctAnswer": "C. Medullary thyroid carcinoma"
  },
  {
    "id": 230,
    "text": "Q13. patient presented with abdominal pain and swelling in his scrotum and was diagnosed to have testicular carcinoma. There is a history of MEN syndrome running in his family. Which of the following conditions is he likely to have?",
    "options": [
      {
        "label": "A",
        "text": "MEN4 ee ee ee en | 128",
        "correct": true
      },
      {
        "label": "B",
        "text": "MEN2A",
        "correct": false
      },
      {
        "label": "C",
        "text": "MEN1",
        "correct": false
      },
      {
        "label": "D",
        "text": "MEN2B a",
        "correct": false
      }
    ],
    "imageData": null,
    "explanationHTML": "<div class=\"explanation\">This patient is likely to have MEN4 syndrome as reproductive organ tumors are a characteristic feature of this condition. 131</div><div class=\"telegram-link\"><small><a href=\"http://t.me/Friendly_neighborhood_medico_bot\"> </a></small></div>",
    "subdeck": "10_Multiple Endocrine Neoplasia",
    "deck_id": 1755954606593,
    "correctAnswer": "A. MEN4 ee ee ee en | 128"
  }
];
        let currentQuestion = 0;
        let answers = [];
        let correctCount = 0;
        let incorrectCount = 0;
        let answeredQuestions = new Set();
        let isTestMode = localStorage.getItem('testMode') === 'true' || false;

        console.log('Quiz loaded with', questions.length, 'questions');
        console.log('Test mode:', isTestMode);

        // Hide stats bar if test mode is enabled
        if (isTestMode) {
            document.addEventListener('DOMContentLoaded', () => {
                document.getElementById('stats-bar').style.display = 'none';
            });
        }

        // Auto-start quiz
        startQuiz();

        function startQuiz() {
            answers = new Array(questions.length).fill(null);
            correctCount = 0;
            incorrectCount = 0;
            answeredQuestions = new Set();
            currentQuestion = 0;
            showQuestion(0);
            updateStats();
        }

        function showQuestion(index) {
            currentQuestion = index;
            const question = questions[index];

            document.getElementById('question-number').textContent = `Question ${index + 1} of ${questions.length}`;
            document.getElementById('question-text').innerHTML = question.text;
            document.getElementById('question-status').textContent = answers[index] ? 'Question answered' : 'Click an option to answer';

            const imagesContainer = document.getElementById('question-images');
            imagesContainer.innerHTML = '';

            if (question.imageData) {
                const img = document.createElement('img');
                img.src = `data:${question.imageData.mime};base64,${question.imageData.data}`;
                img.className = 'medical-image';
                img.alt = 'Medical Question Image';
                imagesContainer.appendChild(img);
            }

            const optionsContainer = document.getElementById('options');
            optionsContainer.innerHTML = '';

            question.options.forEach(option => {
                const button = document.createElement('button');
                button.className = 'option-card w-full p-6 text-left bg-white rounded-xl shadow-lg';
                button.innerHTML = `<span class="font-bold text-blue-600 mr-4">${option.label}.</span>${option.text}`;

                if (!isTestMode && answers[index] !== null) {
                    button.disabled = true;
                    if (option.correct) {
                        button.classList.add('correct');
                    } else if (answers[index] === option.label) {
                        button.classList.add('incorrect');
                    }
                } else {
                    button.onclick = () => selectAnswer(option.label);
                }

                if (answers[index] === option.label) {
                    button.classList.add('selected');
                }

                optionsContainer.appendChild(button);
            });

            // Show feedback only in normal mode and if answered
            if (!isTestMode && answers[index] !== null) {
                showFeedback(index);
            } else {
                document.getElementById('feedback-section').classList.add('hidden');
            }

            document.getElementById('prev-btn').disabled = index === 0;

            if (answers[index] !== null) {
                if (index === questions.length - 1) {
                    document.getElementById('next-btn').classList.add('hidden');
                    document.getElementById('finish-btn').classList.remove('hidden');
                } else {
                    document.getElementById('next-btn').classList.remove('hidden');
                    document.getElementById('finish-btn').classList.add('hidden');
                }
            } else {
                document.getElementById('next-btn').classList.add('hidden');
                document.getElementById('finish-btn').classList.add('hidden');
            }

            const progress = ((index + 1) / questions.length) * 100;
            document.getElementById('progress-bar').style.width = `${progress}%`;
        }

        function selectAnswer(label) {
            const question = questions[currentQuestion];
            const correctOption = question.options.find(opt => opt.correct);
            const isCorrect = correctOption && label === correctOption.label;

            if (!answeredQuestions.has(currentQuestion)) {
                answeredQuestions.add(currentQuestion);
                if (isCorrect) {
                    correctCount++;
                } else {
                    incorrectCount++;
                }
            }

            answers[currentQuestion] = label;
            updateStats();
            
            showQuestion(currentQuestion);
        }

        function showFeedback(questionIndex) {
            const question = questions[questionIndex];
            const userAnswer = answers[questionIndex];
            const correctOption = question.options.find(opt => opt.correct);
            const userOption = question.options.find(opt => opt.label === userAnswer);
            const isCorrect = correctOption && userAnswer === correctOption.label;

            const feedbackSection = document.getElementById('feedback-section');
            const feedbackIcon = document.getElementById('feedback-icon');
            const feedbackMessage = document.getElementById('feedback-message');

            if (isCorrect) {
                feedbackSection.className = 'bg-green-50 border border-green-200 mb-8 p-6 rounded-2xl';
                feedbackIcon.textContent = '‚úÖ';
                feedbackMessage.textContent = 'Correct!';
                feedbackMessage.className = 'text-2xl font-bold mb-2 text-green-700';
            } else {
                feedbackSection.className = 'bg-red-50 border border-red-200 mb-8 p-6 rounded-2xl';
                feedbackIcon.textContent = '‚ùå';
                feedbackMessage.textContent = 'Incorrect';
                feedbackMessage.className = 'text-2xl font-bold mb-2 text-red-700';
            }

            document.getElementById('user-answer-display').innerHTML = `<span class="${isCorrect ? 'text-green-600' : 'text-red-600'}">${userAnswer}. ${userOption?.text || 'Unknown'}</span>`;
            document.getElementById('correct-answer-display').textContent = question.correctAnswer;

            const explanationSection = document.getElementById('explanation-section');
            if (question.explanationHTML && question.explanationHTML.trim()) {
                document.getElementById('explanation-content').innerHTML = question.explanationHTML;
                explanationSection.classList.remove('hidden');
            } else {
                explanationSection.classList.add('hidden');
            }

            feedbackSection.classList.remove('hidden');
        }

        function updateStats() {
            const totalAnswered = correctCount + incorrectCount;
            const accuracy = totalAnswered === 0 ? 0 : Math.round((correctCount / totalAnswered) * 100);

            document.getElementById('correct-stats').textContent = correctCount;
            document.getElementById('incorrect-stats').textContent = incorrectCount;
            document.getElementById('accuracy-stats').textContent = `${accuracy}%`;
            document.getElementById('progress-stats').textContent = `${totalAnswered}/${questions.length}`;
        }

        document.getElementById('prev-btn').onclick = () => {
            if (currentQuestion > 0) {
                showQuestion(currentQuestion - 1);
            }
        };
        
        document.getElementById('next-btn').onclick = () => {
            if (currentQuestion < questions.length - 1) {
                showQuestion(currentQuestion + 1);
            }
        };
        
        document.getElementById('finish-btn').onclick = showFinalResults;

        function showFinalResults() {
            if (isTestMode) {
                showTestModeResults();
            } else {
                showNormalModeResults();
            }
        }

        function showTestModeResults() {
            const accuracy = (correctCount + incorrectCount === 0) ? 0 : Math.round((correctCount / (correctCount + incorrectCount)) * 100);

            document.getElementById('quiz-section').classList.add('hidden');
            document.getElementById('test-results').classList.remove('hidden');

            document.getElementById('test-final-correct').textContent = correctCount;
            document.getElementById('test-final-incorrect').textContent = incorrectCount;
            document.getElementById('test-final-accuracy').textContent = `${accuracy}%`;

            let gradeIcon = 'üéØ';
            if (accuracy >= 90) {
                gradeIcon = 'üèÜ';
            } else if (accuracy >= 80) {
                gradeIcon = 'üéâ';
            } else if (accuracy >= 70) {
                gradeIcon = 'üëç';
            } else if (accuracy >= 60) {
                gradeIcon = 'üìö';
            } else {
                gradeIcon = 'üí™';
            }

            document.getElementById('test-grade-icon').textContent = gradeIcon;

            // Show detailed review
            const reviewContainer = document.getElementById('test-review-details');
            reviewContainer.innerHTML = '';

            questions.forEach((question, index) => {
                const userAnswer = answers[index];
                const correctOption = question.options.find(opt => opt.correct);
                const userOption = question.options.find(opt => opt.label === userAnswer);
                const isCorrect = correctOption && userAnswer === correctOption.label;

                const reviewCard = document.createElement('div');
                reviewCard.className = `border-l-4 p-4 bg-white rounded-lg shadow-sm ${isCorrect ? 'border-green-500' : 'border-red-500'}`;
                
                reviewCard.innerHTML = `
                    <div class="flex items-center justify-between mb-2">
                        <h4 class="font-bold text-gray-800">Question ${index + 1}</h4>
                        <span class="text-2xl">${isCorrect ? '‚úÖ' : '‚ùå'}</span>
                    </div>
                    <p class="text-gray-700 mb-3">${question.text}</p>
                    <div class="grid md:grid-cols-2 gap-4">
                        <div>
                            <strong class="text-gray-600">Your Answer:</strong><br>
                            <span class="${isCorrect ? 'text-green-600' : 'text-red-600'}">${userAnswer}. ${userOption?.text || 'Not answered'}</span>
                        </div>
                        <div>
                            <strong class="text-gray-600">Correct Answer:</strong><br>
                            <span class="text-green-600">${question.correctAnswer}</span>
                        </div>
                    </div>
                    ${question.explanationHTML ? `
                        <div class="mt-3 p-3 bg-blue-50 rounded-lg">
                            <strong class="text-blue-800">Explanation:</strong>
                            <div class="mt-2 explanation-content">${question.explanationHTML}</div>
                        </div>
                    ` : ''}
                `;
                
                reviewContainer.appendChild(reviewCard);
            });
        }

        function showNormalModeResults() {
            const accuracy = (correctCount + incorrectCount === 0) ? 0 : Math.round((correctCount / (correctCount + incorrectCount)) * 100);

            document.getElementById('quiz-section').classList.add('hidden');
            document.getElementById('final-results').classList.remove('hidden');

            document.getElementById('final-correct').textContent = correctCount;
            document.getElementById('final-incorrect').textContent = incorrectCount;
            document.getElementById('final-accuracy').textContent = `${accuracy}%`;

            let gradeIcon = 'üéØ';
            if (accuracy >= 90) {
                gradeIcon = 'üèÜ';
            } else if (accuracy >= 80) {
                gradeIcon = 'üéâ';
            } else if (accuracy >= 70) {
                gradeIcon = 'üëç';
            } else if (accuracy >= 60) {
                gradeIcon = 'üìö';
            } else {
                gradeIcon = 'üí™';
            }

            document.getElementById('final-grade-icon').textContent = gradeIcon;
        }
    </script>
</body>
</html>