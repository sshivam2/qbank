<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>27_Evaluation of Diarrhea - Marrow Medicine</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        .medical-quiz {
            font-family: Segoe UI, Tahoma, Geneva, Verdana, sans-serif;
        }
        
        .question-card {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        }
        
        .option-card {
            transition: all 0.3s ease;
            cursor: pointer;
            border: 2px solid transparent;
        }
        
        .option-card:hover {
            border-color: #3b82f6;
            transform: translateY(-2px);
        }
        
        .option-card.selected {
            background: #3b82f6;
            color: white;
            border-color: #1d4ed8;
        }
        
        .option-card.correct {
            background: #10b981;
            color: white;
            border-color: #059669;
        }
        
        .option-card.incorrect {
            background: #ef4444;
            color: white;
            border-color: #dc2626;
        }
        
        .progress-bar {
            background: linear-gradient(to right, #10b981, #059669);
            transition: width 0.3s;
        }
        
        .medical-image {
            max-width: 100%;
            max-height: 400px;
            height: auto;
            border-radius: 12px;
            margin: 20px auto;
            display: block;
        }
        
        .hidden {
            display: none !important;
        }

        .explanation-content {
            font-family: Segoe UI, Tahoma, Geneva, Verdana, sans-serif;
            font-size: 1.05rem;
            line-height: 1.7;
            color: #374151;
            text-align: left;
        }
        
        .explanation-content p {
            margin-bottom: 1rem;
            text-align: justify;
        }
        
        .explanation-content strong, .explanation-content b {
            font-weight: 600;
            color: #1f2937;
        }
        
        .explanation-content img {
            max-width: 100%;
            height: auto;
            margin: 1.5rem auto;
            display: block;
            border-radius: 8px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }
    </style>
</head>

<body class="bg-gradient-to-br from-blue-50 to-indigo-100 min-h-screen medical-quiz">
    <header class="bg-white shadow-xl p-6">
        <div class="container mx-auto flex justify-between items-center">
            <div>
                <h1 class="text-3xl font-bold text-gray-800">27_Evaluation of Diarrhea</h1>
                <p class="text-gray-600 mt-2">Marrow ‚Ä¢ Medicine ‚Ä¢ Interactive Learning</p>
            </div>
            <div class="flex gap-2">
                <button class="bg-gray-500 text-white px-3 py-2 text-sm rounded-lg hover:bg-gray-600 transition" 
                        onclick="window.location.href='marrow_medicine.html'">
                    ‚Üê Topics
                </button>
                <button class="bg-purple-500 text-white px-3 py-2 text-sm rounded-lg hover:bg-purple-600 transition" 
                        onclick="window.location.href='marrow.html'">
                    üìö Marrow
                </button>
                <button class="bg-blue-500 text-white px-3 py-2 text-sm rounded-lg hover:bg-blue-600 transition" 
                        onclick="window.location.href='index.html'">
                    üè† Home
                </button>
            </div>
        </div>
    </header>

    <!-- Statistics Bar (Hidden in Test Mode) -->
    <div class="bg-white shadow-lg p-4" id="stats-bar">
        <div class="container mx-auto flex justify-center gap-8">
            <div class="text-center">
                <div class="text-2xl font-bold text-green-600" id="correct-stats">0</div>
                <div class="text-sm text-gray-600">Correct</div>
            </div>
            <div class="text-center">
                <div class="text-2xl font-bold text-red-600" id="incorrect-stats">0</div>
                <div class="text-sm text-gray-600">Incorrect</div>
            </div>
            <div class="text-center">
                <div class="text-2xl font-bold text-blue-600" id="accuracy-stats">0%</div>
                <div class="text-sm text-gray-600">Accuracy</div>
            </div>
            <div class="text-center">
                <div class="text-2xl font-bold text-purple-600" id="progress-stats">0/12</div>
                <div class="text-sm text-gray-600">Progress</div>
            </div>
        </div>
    </div>

    <!-- Quiz Section -->
    <section class="container mx-auto p-6" id="quiz-section">
        <div class="bg-white rounded-2xl shadow-xl p-8">
            <!-- Progress Bar -->
            <div class="w-full bg-gray-200 rounded-full h-4 mb-8">
                <div class="progress-bar h-4 rounded-full" id="progress-bar"></div>
            </div>

            <div class="flex justify-between items-center mb-8">
                <h2 class="text-2xl font-bold text-blue-700" id="question-number">Question 1 of 12</h2>
                <div class="text-sm text-gray-600" id="question-status">Click an option to answer</div>
            </div>

            <!-- Question Text -->
            <div class="mb-10">
                <div class="question-card text-white p-8 rounded-2xl mb-8" id="question-text"></div>
                
                <!-- Question Image -->
                <div class="text-center mb-8" id="question-images"></div>
                
                <!-- Options -->
                <div class="space-y-4" id="options"></div>
            </div>

            <!-- Answer Feedback Section (Normal Mode Only) -->
            <div class="hidden mb-8 p-6 rounded-2xl" id="feedback-section">
                <div class="text-center mb-4">
                    <div class="text-6xl mb-2" id="feedback-icon"></div>
                    <div class="text-2xl font-bold mb-2" id="feedback-message">Correct!</div>
                </div>
                
                <div class="grid md:grid-cols-2 gap-4 mb-4">
                    <div class="bg-white p-4 rounded-xl border">
                        <strong>Your Answer:</strong><br>
                        <span id="user-answer-display"></span>
                    </div>
                    <div class="bg-white p-4 rounded-xl border">
                        <strong>Correct Answer:</strong><br>
                        <span class="text-green-600" id="correct-answer-display"></span>
                    </div>
                </div>
                
                <div class="bg-blue-50 p-6 rounded-xl" id="explanation-section">
                    <strong class="text-lg text-blue-800">Explanation:</strong>
                    <div id="explanation-content" class="mt-3 explanation-content"></div>
                </div>
            </div>

            <!-- Navigation -->
            <div class="flex justify-between gap-4">
                <button class="bg-gray-400 text-white px-6 py-3 rounded-xl hover:bg-gray-500 transition" 
                        onclick="window.location.href='marrow_medicine.html'">
                    Back to Topics
                </button>
                
                <div class="flex gap-4">
                    <button class="bg-gray-400 text-white px-6 py-3 rounded-xl disabled" id="prev-btn">
                        Previous
                    </button>
                    <button class="bg-blue-500 text-white px-6 py-3 rounded-xl hidden" id="next-btn">
                        Next
                    </button>
                    <button class="bg-green-600 text-white px-6 py-3 rounded-xl font-bold hidden" id="finish-btn">
                        Finish Quiz
                    </button>
                </div>
            </div>
        </div>
    </section>

    <!-- Test Mode Final Results -->
    <section class="container mx-auto p-6 hidden" id="test-results">
        <div class="bg-white rounded-2xl shadow-xl p-8">
            <div class="text-center mb-8">
                <h2 class="text-4xl font-bold mb-4 text-blue-700">Test Complete! üéâ</h2>
                <div class="text-6xl mb-4" id="test-grade-icon">üéØ</div>
            </div>
            
            <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-8">
                <div class="bg-green-100 p-6 rounded-2xl text-center">
                    <div class="text-4xl font-bold text-green-600" id="test-final-correct">0</div>
                    <div class="font-semibold text-green-700">Correct Answers</div>
                </div>
                <div class="bg-red-100 p-6 rounded-2xl text-center">
                    <div class="text-4xl font-bold text-red-600" id="test-final-incorrect">0</div>
                    <div class="font-semibold text-red-700">Incorrect Answers</div>
                </div>
                <div class="bg-blue-100 p-6 rounded-2xl text-center">
                    <div class="text-4xl font-bold text-blue-600" id="test-final-accuracy">0%</div>
                    <div class="font-semibold text-blue-700">Final Accuracy</div>
                </div>
            </div>

            <!-- Detailed Review -->
            <div class="mb-8">
                <h3 class="text-2xl font-bold text-gray-800 mb-4">üìã Detailed Review</h3>
                <div id="test-review-details" class="space-y-4"></div>
            </div>
            
            <div class="flex justify-center gap-4">
                <button class="bg-purple-600 text-white px-8 py-3 rounded-xl font-bold hover:bg-purple-700 transition" 
                        onclick="window.location.href='marrow_medicine.html'">
                    Back to Topics
                </button>
                <button class="bg-blue-600 text-white px-8 py-3 rounded-xl font-bold hover:bg-blue-700 transition" 
                        onclick="window.location.reload()">
                    Retake Quiz
                </button>
            </div>
        </div>
    </section>

    <!-- Normal Mode Final Results -->
    <section class="container mx-auto p-6 hidden" id="final-results">
        <div class="bg-white rounded-2xl shadow-xl p-8">
            <div class="text-center mb-8">
                <h2 class="text-4xl font-bold mb-4 text-blue-700">Quiz Complete! üéâ</h2>
                <div class="text-6xl mb-4" id="final-grade-icon">üéØ</div>
            </div>
            
            <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-8">
                <div class="bg-green-100 p-6 rounded-2xl text-center">
                    <div class="text-4xl font-bold text-green-600" id="final-correct">0</div>
                    <div class="font-semibold text-green-700">Correct Answers</div>
                </div>
                <div class="bg-red-100 p-6 rounded-2xl text-center">
                    <div class="text-4xl font-bold text-red-600" id="final-incorrect">0</div>
                    <div class="font-semibold text-red-700">Incorrect Answers</div>
                </div>
                <div class="bg-blue-100 p-6 rounded-2xl text-center">
                    <div class="text-4xl font-bold text-blue-600" id="final-accuracy">0%</div>
                    <div class="font-semibold text-blue-700">Final Accuracy</div>
                </div>
            </div>
            
            <div class="flex justify-center gap-4">
                <button class="bg-purple-600 text-white px-8 py-3 rounded-xl font-bold hover:bg-purple-700 transition" 
                        onclick="window.location.href='marrow_medicine.html'">
                    Back to Topics
                </button>
                <button class="bg-blue-600 text-white px-8 py-3 rounded-xl font-bold hover:bg-blue-700 transition" 
                        onclick="window.location.reload()">
                    Retake Quiz
                </button>
            </div>
        </div>
    </section>

    <script>
        const questions = [
  {
    "id": 533,
    "text": "Q1. patient presents with chronic diarrhea, bloating sensation, and weight loss. History is significant for stools that are bulky, pale, foul-smelling, and difficult to flush. Further testing reveals fecal fat excretion of 8. 2g/day. Which of the following would be a differential diagnosis?",
    "options": [
      {
        "label": "A",
        "text": "Short bowel syndrome",
        "correct": true
      },
      {
        "label": "B",
        "text": "Primary lactase deficiency",
        "correct": false
      },
      {
        "label": "C",
        "text": "Pernicious anemia",
        "correct": false
      },
      {
        "label": "D",
        "text": "Wilson&apos;s disease",
        "correct": false
      }
    ],
    "imageData": null,
    "explanationHTML": "<div class=\"explanation\">The above scenario is suggestive of steatorrhoea, which is seen in short bowel syndrome. Steatorrhoea is defined as excess fat in stools (&amp;gt; 7g/day) due to poor absorption of lipids. It is characterized by stools are bulky, pale, foul-smelling, and difficult to flush. Short bowel syndrome (SBS) is a malabsorption disorder caused by a lack of functional small intestine. It can lead to the typical features of malabsorption such as abdominal pain, diarrhoea, steatorrhoea, weight loss and anaemia. Option B: Primary lactase deficiency leads to defective absorption of lactose. It does not affect lipid absorption. Option C: Pernicious anemia is due to an absence of gastric parietal cell-intrinsic factor which is necessary for the absorption of vitamin B12. Option D: Wilson's disease is associated with increased absorption of copper and is not a part of malabsorption syndrome.</div><div class=\"telegram-link\"><small><a href=\"http://t.me/Friendly_neighborhood_medico_bot\"> </a></small></div>",
    "subdeck": "27_Evaluation of Diarrhea",
    "deck_id": 1755954606731,
    "correctAnswer": "A. Short bowel syndrome"
  },
  {
    "id": 534,
    "text": "Q2. 22-year-old man presented with diarrhea and intolerance to dairy products. On investigation, he was found to have a lactase deficiency. Which of the following agents is least likely to cause symptoms of lactose intolerance?",
    "options": [
      {
        "label": "A",
        "text": "Condensed Milk",
        "correct": false
      },
      {
        "label": "B",
        "text": "Skimmed Milk",
        "correct": false
      },
      {
        "label": "C",
        "text": "Yogurt",
        "correct": true
      },
      {
        "label": "D",
        "text": "Ice Cream",
        "correct": false
      }
    ],
    "imageData": null,
    "explanationHTML": "<div class=\"explanation\">Yogurt is the least likely to cause symptoms of lactose intolerance. It contains lactobacillus that produces lactase and is generally well tolerated. Lactase is a brush border enzyme that hydrolyzes lactose into glucose and galactose. In lactase deficiency, patients have great variability in clinical symptoms, depending on both the severity of lactase deficiency and the amount of lactose ingested. The goal of treatment in patients with isolated lactase deficiency is achieving patient comfort through the elimination of dietary lactose. Foods that are high in lactose include milk (12 g/cup), ice cream (9 g/cup), and cottage cheese (8 g/cup). Aged cheese has lower lactose content. Most people can tolerate up to 12g of lactose a day 368 without significant symptoms.</div><div class=\"telegram-link\"><small><a href=\"http://t.me/Friendly_neighborhood_medico_bot\"> </a></small></div>",
    "subdeck": "27_Evaluation of Diarrhea",
    "deck_id": 1755954606731,
    "correctAnswer": "C. Yogurt"
  },
  {
    "id": 535,
    "text": "Q3. Which of the following is incorrect about lactose intolerance?",
    "options": [
      {
        "label": "A",
        "text": "It may be seen in celiac disease",
        "correct": false
      },
      {
        "label": "B",
        "text": "It can mimic irritable bowel syndrome",
        "correct": false
      },
      {
        "label": "C",
        "text": "Delayed gastric emptying decreases the symptoms",
        "correct": false
      },
      {
        "label": "D",
        "text": "Rapid small-intestinal transit time decreases the symptoms",
        "correct": true
      }
    ],
    "imageData": null,
    "explanationHTML": "<div class=\"explanation\">Rapid small-intestinal transit time increases the symptoms of lactose intolerance. Lactose intolerance can be due to: * Primary lactase deficiencya genetically determined deficiency or absence of lactase enzyme * Secondary lactase deficiencydue to small intestinal mucosal diseases such as celiac disease Factors affecting symptoms of lactose intolerance: ¬¢ Amount of lactose in the diet. * Rate of gastric emptyingsymptoms are more likely when gastric emptying is rapid (post-gastrectomy and skimmed milk intake). ¬¢ Small intestinal transit timemore rapid small intestinal transit time makes symptoms more likely. ¬¢ Antibiotic useresults in decreased colonic microflora which in turn decreases the production of easily absorbed short-chain fatty acids from non-absorbed lactose. This can worsen the symptoms.</div><div class=\"telegram-link\"><small><a href=\"http://t.me/Friendly_neighborhood_medico_bot\"> </a></small></div>",
    "subdeck": "27_Evaluation of Diarrhea",
    "deck_id": 1755954606731,
    "correctAnswer": "D. Rapid small-intestinal transit time decreases the symptoms"
  },
  {
    "id": 536,
    "text": "Q4. 364 Which of the following is unlikely to be present in a patient with large bowel diarrhea?",
    "options": [
      {
        "label": "A",
        "text": "Steatorrhea",
        "correct": true
      },
      {
        "label": "B",
        "text": "Small volume stools",
        "correct": false
      },
      {
        "label": "C",
        "text": "Blood and mucus in stools",
        "correct": false
      },
      {
        "label": "D",
        "text": "Tenesmus",
        "correct": false
      }
    ],
    "imageData": null,
    "explanationHTML": "<div class=\"explanation\">Small bowel diarrhea is associated with steatorrhea, not large bowel diarrhea. Tenesmus refers to the constant urge to defecate with little or no stool passed. d Blood and mucus in stoo | Absent Present ls Vomiting May be pres | Infreque ent nt</div><div class=\"telegram-link\"><small><a href=\"http://t.me/Friendly_neighborhood_medico_bot\"> </a></small></div>",
    "subdeck": "27_Evaluation of Diarrhea",
    "deck_id": 1755954606731,
    "correctAnswer": "A. Steatorrhea"
  },
  {
    "id": 537,
    "text": "Q5. All are true regarding osmotic diarrhea except :",
    "options": [
      {
        "label": "A",
        "text": "Fasting improves the symptoms",
        "correct": false
      },
      {
        "label": "B",
        "text": "Stool osmolar gap &amp;gt;100 mOsm",
        "correct": false
      },
      {
        "label": "C",
        "text": "Increased osmolarity of stool is due to unabsorbed dietary nutrients",
        "correct": false
      },
      {
        "label": "D",
        "text": "Are associated with enterotoxigenic E. coli",
        "correct": true
      }
    ],
    "imageData": null,
    "explanationHTML": "<div class=\"explanation\">Enterotoxigenic E. coli (ETEC) is associated with secretory diarrhea. 369 Stool osmolar gap = measured osmolality - calculated osmolality = (290 to 300) - 2 (stool Na+ + stool K+) Definition Diarrhea due to poorly absor | Diarrhea due to excessive sec bed osmotically active substa | retion of NaCl, HCO3-, and w nces in the colonic lumen. ater into the gut. Stool osmolar gap (mOs | &gt;100 &lt;50 m) Causes Malabsorption syndrome Tumors - VIPomaToxins - ET EC, V. cholera</div><div class=\"telegram-link\"><small><a href=\"http://t.me/Friendly_neighborhood_medico_bot\"> </a></small></div>",
    "subdeck": "27_Evaluation of Diarrhea",
    "deck_id": 1755954606731,
    "correctAnswer": "D. Are associated with enterotoxigenic E. coli"
  },
  {
    "id": 538,
    "text": "Q6. 32-year-old woman presents with complaints of abdominal pain and recurrent diarrhea for several months. History reveals that she regularly goes on camping trips. Stool osmolality was 200 mOsm/kg H20 and the stool osmolar gap was 20 mOsm/kg H20. What is the most likely diagnosis?",
    "options": [
      {
        "label": "A",
        "text": "Secretory diarrhea",
        "correct": false
      },
      {
        "label": "B",
        "text": "Osmotic diarrhea",
        "correct": false
      },
      {
        "label": "C",
        "text": "Factitious diarrhea",
        "correct": true
      },
      {
        "label": "D",
        "text": "Infectious diarrhea",
        "correct": false
      }
    ],
    "imageData": null,
    "explanationHTML": "<div class=\"explanation\">The most likely diagnosis is factitious diarrhea. Factitious diarrhoea is a form of Miinchausen's syndrome. In patients with diarrhea, stool osmolality is always &amp;gt; 290-300 mOsm/kg H20. A stool osmolality of &amp;lt; 290 mOsm/kg H20 is suggestive of dilution with urine or water to the sample, by the patient. In this case stool osmolality can be lower than plasma osmolality (&amp;lt; 250 mOsm/kg) or very high (&amp;gt; 400 mOsm/kg) due to purposeful dilution with hypotonic/concentrated solute by the patient to the stool sample. The stool osmolar gap is used to differentiate between osmotic and secretory diarrhea. A gap of: * &amp;lt; 50 suggests secretory diarrhoea * &amp;gt; 100 suggests osmotic diarrhoea Stool osmolar gap = measured osmolality - calculated osmolality = (290 to 300) - 2 (stool Na+ + stool K+)</div><div class=\"telegram-link\"><small><a href=\"http://t.me/Friendly_neighborhood_medico_bot\"> </a></small></div>",
    "subdeck": "27_Evaluation of Diarrhea",
    "deck_id": 1755954606731,
    "correctAnswer": "C. Factitious diarrhea"
  },
  {
    "id": 539,
    "text": "Q7. All are true regarding bile acid diarrhea except :",
    "options": [
      {
        "label": "A",
        "text": "Seen in limited ileal disease",
        "correct": false
      },
      {
        "label": "B",
        "text": "No or mild steatorrhea",
        "correct": false
      },
      {
        "label": "C",
        "text": "Normal bile acid pool size",
        "correct": false
      },
      {
        "label": "D",
        "text": "Good response to low fat diet 365",
        "correct": true
      }
    ],
    "imageData": null,
    "explanationHTML": "<div class=\"explanation\">Bile acid diarrhea has no response to a low-fat diet. Fecal bile acid loss compensa | Yes No ted by hepatic synthesis 370</div><div class=\"telegram-link\"><small><a href=\"http://t.me/Friendly_neighborhood_medico_bot\"> </a></small></div>",
    "subdeck": "27_Evaluation of Diarrhea",
    "deck_id": 1755954606731,
    "correctAnswer": "D. Good response to low fat diet 365"
  },
  {
    "id": 540,
    "text": "Q8. Which of the following is the most common viral cause of diarrhea in adults?",
    "options": [
      {
        "label": "A",
        "text": "Enterovirus",
        "correct": false
      },
      {
        "label": "B",
        "text": "Rotavirus",
        "correct": false
      },
      {
        "label": "C",
        "text": "Norovirus",
        "correct": true
      },
      {
        "label": "D",
        "text": "Cytomegalovirus",
        "correct": false
      }
    ],
    "imageData": null,
    "explanationHTML": "<div class=\"explanation\">The most common viral cause of diarrhoea in adults (and overall) is norovirus (Norwalk virus). In children, the most common cause is rotavirus.</div><div class=\"telegram-link\"><small><a href=\"http://t.me/Friendly_neighborhood_medico_bot\"> </a></small></div>",
    "subdeck": "27_Evaluation of Diarrhea",
    "deck_id": 1755954606731,
    "correctAnswer": "C. Norovirus"
  },
  {
    "id": 541,
    "text": "Q9. father brings his 12-year-old son with complaints of severe abdominal pain and diarrhea. The pain is localized to the right iliac fossa. USG abdomen reveals enlarged mesenteric lymph nodes and a normal appendix. Which of the following is the likely causative organism?",
    "options": [
      {
        "label": "A",
        "text": "Yersinia enterocolitica",
        "correct": true
      },
      {
        "label": "B",
        "text": "Campylobacter jejuni",
        "correct": false
      },
      {
        "label": "C",
        "text": "Shigella dysenteriae",
        "correct": false
      },
      {
        "label": "D",
        "text": "Salmonella enterica",
        "correct": false
      }
    ],
    "imageData": null,
    "explanationHTML": "<div class=\"explanation\">Yersinia enterocolitica causes diarrhea with symptoms resembling appendicitis, also called pseudoappendicitis. The patients present with abdominal pain which can be localized to the right iliac fossa, thus mimicking appendicitis. USG shows a normal appendix and may show enlarged mesenteric lymph nodes. Appendectomy is not indicated for Yersinia infection pseudoappendicitis. Campylobacter jejun | Triggers Guillain-Barr√© synd i rome,Small bowel lymphopro liferative disorder Shigella dysenteriae | Severe colitis affecting all 4 1 ayers Nontyphoid Salmon | Aortic /Endovascular infectio ella n</div><div class=\"telegram-link\"><small><a href=\"http://t.me/Friendly_neighborhood_medico_bot\"> </a></small></div>",
    "subdeck": "27_Evaluation of Diarrhea",
    "deck_id": 1755954606731,
    "correctAnswer": "A. Yersinia enterocolitica"
  },
  {
    "id": 542,
    "text": "Q10. Which of the following is not associated with travellers‚Äô diarrhoea?",
    "options": [
      {
        "label": "A",
        "text": "Shigella",
        "correct": false
      },
      {
        "label": "B",
        "text": "Norovirus",
        "correct": false
      },
      {
        "label": "C",
        "text": "Giardia",
        "correct": false
      },
      {
        "label": "D",
        "text": "Enterovirus",
        "correct": true
      }
    ],
    "imageData": null,
    "explanationHTML": "<div class=\"explanation\">Enterovirus is not an etiological agent for travelers‚Äô diarrhea. The various causes of travelers' diarrhea are as follows: * Bacterial * Enterotoxigenic E. coli (ETEC)most common * Shigella 371 * Salmonella ¬∞ S. aureus * B. cereus * Viral ¬¢ Norovirus * Rotavirus * Parasite * Giardia lamblia ¬¢ Entamoeba histolytica.</div><div class=\"telegram-link\"><small><a href=\"http://t.me/Friendly_neighborhood_medico_bot\"> </a></small></div>",
    "subdeck": "27_Evaluation of Diarrhea",
    "deck_id": 1755954606731,
    "correctAnswer": "D. Enterovirus"
  },
  {
    "id": 543,
    "text": "Q11. child was brought with complaints of watery diarrhea for 48 hours. On examination, tachycardia and decreased skin turgor were present. Stool microscopy revealed the following organisms. Which of the given findings is likely to be seen in this patient?",
    "options": [
      {
        "label": "A",
        "text": "366 ‚Äî aS! ‚ÄúSera Sas. roots ‚Äô = ete. rs a Se Ae J pay. i 3 ss, ; ee : ‚Äî oo ~ ‚Äî _ ‚Äò 2 Fae of . FES Hypokalemic acidosis",
        "correct": true
      },
      {
        "label": "B",
        "text": "Hypokalemic alkalosis",
        "correct": false
      },
      {
        "label": "C",
        "text": "Hyperkalemic acidosis",
        "correct": false
      },
      {
        "label": "D",
        "text": "Hyperkalemic alkalosis",
        "correct": false
      }
    ],
    "imageData": null,
    "explanationHTML": "<div class=\"explanation\">The image shows the characteristic fish in stream appearance of Vibrio, suggestive of cholera. Diarrhea due to Vibrio cholerae results in hypokalemic acidosis. Cholera exotoxin activates adenylate cyclase (T cAMP) leading to loss of bicarbonate, water, and electrolytes leading to hypokalemic acidosis. Note: The other cause for hypokalemic acidosis is renal tubular acidosis.</div><div class=\"telegram-link\"><small><a href=\"http://t.me/Friendly_neighborhood_medico_bot\"> </a></small></div>",
    "subdeck": "27_Evaluation of Diarrhea",
    "deck_id": 1755954606731,
    "correctAnswer": "A. 366 ‚Äî aS! ‚ÄúSera Sas. roots ‚Äô = ete. rs a Se Ae J pay. i 3 ss, ; ee : ‚Äî oo ~ ‚Äî _ ‚Äò 2 Fae of . FES Hypokalemic acidosis"
  },
  {
    "id": 544,
    "text": "Q12. 19-year-old woman presents to the ER with complaints of acute onset nausea, vomiting, and diarrhea. She gives a history of consumption of street food earlier the same day. Which of the following organisms is likely to be responsible for her condition?",
    "options": [
      {
        "label": "A",
        "text": "Vibrio cholerae ee ee ee ee 367",
        "correct": false
      },
      {
        "label": "B",
        "text": "Salmonella enterocolitis",
        "correct": false
      },
      {
        "label": "C",
        "text": "Enterotoxigenic E. coli",
        "correct": false
      },
      {
        "label": "D",
        "text": "Staphylococcus aureus",
        "correct": true
      }
    ],
    "imageData": null,
    "explanationHTML": "<div class=\"explanation\">The above scenario is suggestive of acute onset gastroenteritis. Since the symptoms appeared shortly after ingestion, they are caused due to preformed toxins. From the given options, Staphylococcus aureus is associated with preformed toxins. Etiology of gastroenteritis are as follows : 1. Preformed toxin: * Staphylococcus aureus * Bacillus cereus * Clostridium perfringens 2. Toxin forming: ¬¢ Vibrio cholerae * Enterotoxigenic E. coli (ETEC) 3. Invasive: * Shigella * Salmonella * Yersinia 372 * Campylobacter 373</div><div class=\"telegram-link\"><small><a href=\"http://t.me/Friendly_neighborhood_medico_bot\"> </a></small></div>",
    "subdeck": "27_Evaluation of Diarrhea",
    "deck_id": 1755954606731,
    "correctAnswer": "D. Staphylococcus aureus"
  }
];
        let currentQuestion = 0;
        let answers = [];
        let correctCount = 0;
        let incorrectCount = 0;
        let answeredQuestions = new Set();
        let isTestMode = localStorage.getItem('testMode') === 'true' || false;

        console.log('Quiz loaded with', questions.length, 'questions');
        console.log('Test mode:', isTestMode);

        // Hide stats bar if test mode is enabled
        if (isTestMode) {
            document.addEventListener('DOMContentLoaded', () => {
                document.getElementById('stats-bar').style.display = 'none';
            });
        }

        // Auto-start quiz
        startQuiz();

        function startQuiz() {
            answers = new Array(questions.length).fill(null);
            correctCount = 0;
            incorrectCount = 0;
            answeredQuestions = new Set();
            currentQuestion = 0;
            showQuestion(0);
            updateStats();
        }

        function showQuestion(index) {
            currentQuestion = index;
            const question = questions[index];

            document.getElementById('question-number').textContent = `Question ${index + 1} of ${questions.length}`;
            document.getElementById('question-text').innerHTML = question.text;
            document.getElementById('question-status').textContent = answers[index] ? 'Question answered' : 'Click an option to answer';

            const imagesContainer = document.getElementById('question-images');
            imagesContainer.innerHTML = '';

            if (question.imageData) {
                const img = document.createElement('img');
                img.src = `data:${question.imageData.mime};base64,${question.imageData.data}`;
                img.className = 'medical-image';
                img.alt = 'Medical Question Image';
                imagesContainer.appendChild(img);
            }

            const optionsContainer = document.getElementById('options');
            optionsContainer.innerHTML = '';

            question.options.forEach(option => {
                const button = document.createElement('button');
                button.className = 'option-card w-full p-6 text-left bg-white rounded-xl shadow-lg';
                button.innerHTML = `<span class="font-bold text-blue-600 mr-4">${option.label}.</span>${option.text}`;

                if (!isTestMode && answers[index] !== null) {
                    button.disabled = true;
                    if (option.correct) {
                        button.classList.add('correct');
                    } else if (answers[index] === option.label) {
                        button.classList.add('incorrect');
                    }
                } else {
                    button.onclick = () => selectAnswer(option.label);
                }

                if (answers[index] === option.label) {
                    button.classList.add('selected');
                }

                optionsContainer.appendChild(button);
            });

            // Show feedback only in normal mode and if answered
            if (!isTestMode && answers[index] !== null) {
                showFeedback(index);
            } else {
                document.getElementById('feedback-section').classList.add('hidden');
            }

            document.getElementById('prev-btn').disabled = index === 0;

            if (answers[index] !== null) {
                if (index === questions.length - 1) {
                    document.getElementById('next-btn').classList.add('hidden');
                    document.getElementById('finish-btn').classList.remove('hidden');
                } else {
                    document.getElementById('next-btn').classList.remove('hidden');
                    document.getElementById('finish-btn').classList.add('hidden');
                }
            } else {
                document.getElementById('next-btn').classList.add('hidden');
                document.getElementById('finish-btn').classList.add('hidden');
            }

            const progress = ((index + 1) / questions.length) * 100;
            document.getElementById('progress-bar').style.width = `${progress}%`;
        }

        function selectAnswer(label) {
            const question = questions[currentQuestion];
            const correctOption = question.options.find(opt => opt.correct);
            const isCorrect = correctOption && label === correctOption.label;

            if (!answeredQuestions.has(currentQuestion)) {
                answeredQuestions.add(currentQuestion);
                if (isCorrect) {
                    correctCount++;
                } else {
                    incorrectCount++;
                }
            }

            answers[currentQuestion] = label;
            updateStats();
            
            showQuestion(currentQuestion);
        }

        function showFeedback(questionIndex) {
            const question = questions[questionIndex];
            const userAnswer = answers[questionIndex];
            const correctOption = question.options.find(opt => opt.correct);
            const userOption = question.options.find(opt => opt.label === userAnswer);
            const isCorrect = correctOption && userAnswer === correctOption.label;

            const feedbackSection = document.getElementById('feedback-section');
            const feedbackIcon = document.getElementById('feedback-icon');
            const feedbackMessage = document.getElementById('feedback-message');

            if (isCorrect) {
                feedbackSection.className = 'bg-green-50 border border-green-200 mb-8 p-6 rounded-2xl';
                feedbackIcon.textContent = '‚úÖ';
                feedbackMessage.textContent = 'Correct!';
                feedbackMessage.className = 'text-2xl font-bold mb-2 text-green-700';
            } else {
                feedbackSection.className = 'bg-red-50 border border-red-200 mb-8 p-6 rounded-2xl';
                feedbackIcon.textContent = '‚ùå';
                feedbackMessage.textContent = 'Incorrect';
                feedbackMessage.className = 'text-2xl font-bold mb-2 text-red-700';
            }

            document.getElementById('user-answer-display').innerHTML = `<span class="${isCorrect ? 'text-green-600' : 'text-red-600'}">${userAnswer}. ${userOption?.text || 'Unknown'}</span>`;
            document.getElementById('correct-answer-display').textContent = question.correctAnswer;

            const explanationSection = document.getElementById('explanation-section');
            if (question.explanationHTML && question.explanationHTML.trim()) {
                document.getElementById('explanation-content').innerHTML = question.explanationHTML;
                explanationSection.classList.remove('hidden');
            } else {
                explanationSection.classList.add('hidden');
            }

            feedbackSection.classList.remove('hidden');
        }

        function updateStats() {
            const totalAnswered = correctCount + incorrectCount;
            const accuracy = totalAnswered === 0 ? 0 : Math.round((correctCount / totalAnswered) * 100);

            document.getElementById('correct-stats').textContent = correctCount;
            document.getElementById('incorrect-stats').textContent = incorrectCount;
            document.getElementById('accuracy-stats').textContent = `${accuracy}%`;
            document.getElementById('progress-stats').textContent = `${totalAnswered}/${questions.length}`;
        }

        document.getElementById('prev-btn').onclick = () => {
            if (currentQuestion > 0) {
                showQuestion(currentQuestion - 1);
            }
        };
        
        document.getElementById('next-btn').onclick = () => {
            if (currentQuestion < questions.length - 1) {
                showQuestion(currentQuestion + 1);
            }
        };
        
        document.getElementById('finish-btn').onclick = showFinalResults;

        function showFinalResults() {
            if (isTestMode) {
                showTestModeResults();
            } else {
                showNormalModeResults();
            }
        }

        function showTestModeResults() {
            const accuracy = (correctCount + incorrectCount === 0) ? 0 : Math.round((correctCount / (correctCount + incorrectCount)) * 100);

            document.getElementById('quiz-section').classList.add('hidden');
            document.getElementById('test-results').classList.remove('hidden');

            document.getElementById('test-final-correct').textContent = correctCount;
            document.getElementById('test-final-incorrect').textContent = incorrectCount;
            document.getElementById('test-final-accuracy').textContent = `${accuracy}%`;

            let gradeIcon = 'üéØ';
            if (accuracy >= 90) {
                gradeIcon = 'üèÜ';
            } else if (accuracy >= 80) {
                gradeIcon = 'üéâ';
            } else if (accuracy >= 70) {
                gradeIcon = 'üëç';
            } else if (accuracy >= 60) {
                gradeIcon = 'üìö';
            } else {
                gradeIcon = 'üí™';
            }

            document.getElementById('test-grade-icon').textContent = gradeIcon;

            // Show detailed review
            const reviewContainer = document.getElementById('test-review-details');
            reviewContainer.innerHTML = '';

            questions.forEach((question, index) => {
                const userAnswer = answers[index];
                const correctOption = question.options.find(opt => opt.correct);
                const userOption = question.options.find(opt => opt.label === userAnswer);
                const isCorrect = correctOption && userAnswer === correctOption.label;

                const reviewCard = document.createElement('div');
                reviewCard.className = `border-l-4 p-4 bg-white rounded-lg shadow-sm ${isCorrect ? 'border-green-500' : 'border-red-500'}`;
                
                reviewCard.innerHTML = `
                    <div class="flex items-center justify-between mb-2">
                        <h4 class="font-bold text-gray-800">Question ${index + 1}</h4>
                        <span class="text-2xl">${isCorrect ? '‚úÖ' : '‚ùå'}</span>
                    </div>
                    <p class="text-gray-700 mb-3">${question.text}</p>
                    <div class="grid md:grid-cols-2 gap-4">
                        <div>
                            <strong class="text-gray-600">Your Answer:</strong><br>
                            <span class="${isCorrect ? 'text-green-600' : 'text-red-600'}">${userAnswer}. ${userOption?.text || 'Not answered'}</span>
                        </div>
                        <div>
                            <strong class="text-gray-600">Correct Answer:</strong><br>
                            <span class="text-green-600">${question.correctAnswer}</span>
                        </div>
                    </div>
                    ${question.explanationHTML ? `
                        <div class="mt-3 p-3 bg-blue-50 rounded-lg">
                            <strong class="text-blue-800">Explanation:</strong>
                            <div class="mt-2 explanation-content">${question.explanationHTML}</div>
                        </div>
                    ` : ''}
                `;
                
                reviewContainer.appendChild(reviewCard);
            });
        }

        function showNormalModeResults() {
            const accuracy = (correctCount + incorrectCount === 0) ? 0 : Math.round((correctCount / (correctCount + incorrectCount)) * 100);

            document.getElementById('quiz-section').classList.add('hidden');
            document.getElementById('final-results').classList.remove('hidden');

            document.getElementById('final-correct').textContent = correctCount;
            document.getElementById('final-incorrect').textContent = incorrectCount;
            document.getElementById('final-accuracy').textContent = `${accuracy}%`;

            let gradeIcon = 'üéØ';
            if (accuracy >= 90) {
                gradeIcon = 'üèÜ';
            } else if (accuracy >= 80) {
                gradeIcon = 'üéâ';
            } else if (accuracy >= 70) {
                gradeIcon = 'üëç';
            } else if (accuracy >= 60) {
                gradeIcon = 'üìö';
            } else {
                gradeIcon = 'üí™';
            }

            document.getElementById('final-grade-icon').textContent = gradeIcon;
        }
    </script>
</body>
</html>