<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>07_Other Psychotic Disorders - Marrow Psychiatry</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        .medical-quiz {
            font-family: Segoe UI, Tahoma, Geneva, Verdana, sans-serif;
        }
        
        .question-card {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        }
        
        .option-card {
            transition: all 0.3s ease;
            cursor: pointer;
            border: 2px solid transparent;
        }
        
        .option-card:hover {
            border-color: #3b82f6;
            transform: translateY(-2px);
        }
        
        .option-card.selected {
            background: #3b82f6;
            color: white;
            border-color: #1d4ed8;
        }
        
        .option-card.correct {
            background: #10b981;
            color: white;
            border-color: #059669;
        }
        
        .option-card.incorrect {
            background: #ef4444;
            color: white;
            border-color: #dc2626;
        }
        
        .progress-bar {
            background: linear-gradient(to right, #10b981, #059669);
            transition: width 0.3s;
        }
        
        .medical-image {
            max-width: 100%;
            max-height: 400px;
            height: auto;
            border-radius: 12px;
            margin: 20px auto;
            display: block;
        }
        
        .hidden {
            display: none !important;
        }

        .explanation-content {
            font-family: Segoe UI, Tahoma, Geneva, Verdana, sans-serif;
            font-size: 1.05rem;
            line-height: 1.7;
            color: #374151;
            text-align: left;
        }
        
        .explanation-content p {
            margin-bottom: 1rem;
            text-align: justify;
        }
        
        .explanation-content strong, .explanation-content b {
            font-weight: 600;
            color: #1f2937;
        }
        
        .explanation-content img {
            max-width: 100%;
            height: auto;
            margin: 1.5rem auto;
            display: block;
            border-radius: 8px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }
    </style>
</head>

<body class="bg-gradient-to-br from-blue-50 to-indigo-100 min-h-screen medical-quiz">
    <header class="bg-white shadow-xl p-6">
        <div class="container mx-auto flex justify-between items-center">
            <div>
                <h1 class="text-3xl font-bold text-gray-800">07_Other Psychotic Disorders</h1>
                <p class="text-gray-600 mt-2">Marrow ‚Ä¢ Psychiatry ‚Ä¢ Interactive Learning</p>
            </div>
            <div class="flex gap-2">
                <button class="bg-gray-500 text-white px-3 py-2 text-sm rounded-lg hover:bg-gray-600 transition" 
                        onclick="window.location.href='marrow_psychiatry.html'">
                    ‚Üê Topics
                </button>
                <button class="bg-purple-500 text-white px-3 py-2 text-sm rounded-lg hover:bg-purple-600 transition" 
                        onclick="window.location.href='marrow.html'">
                    üìö Marrow
                </button>
                <button class="bg-blue-500 text-white px-3 py-2 text-sm rounded-lg hover:bg-blue-600 transition" 
                        onclick="window.location.href='index.html'">
                    üè† Home
                </button>
            </div>
        </div>
    </header>

    <!-- Statistics Bar (Hidden in Test Mode) -->
    <div class="bg-white shadow-lg p-4" id="stats-bar">
        <div class="container mx-auto flex justify-center gap-8">
            <div class="text-center">
                <div class="text-2xl font-bold text-green-600" id="correct-stats">0</div>
                <div class="text-sm text-gray-600">Correct</div>
            </div>
            <div class="text-center">
                <div class="text-2xl font-bold text-red-600" id="incorrect-stats">0</div>
                <div class="text-sm text-gray-600">Incorrect</div>
            </div>
            <div class="text-center">
                <div class="text-2xl font-bold text-blue-600" id="accuracy-stats">0%</div>
                <div class="text-sm text-gray-600">Accuracy</div>
            </div>
            <div class="text-center">
                <div class="text-2xl font-bold text-purple-600" id="progress-stats">0/10</div>
                <div class="text-sm text-gray-600">Progress</div>
            </div>
        </div>
    </div>

    <!-- Quiz Section -->
    <section class="container mx-auto p-6" id="quiz-section">
        <div class="bg-white rounded-2xl shadow-xl p-8">
            <!-- Progress Bar -->
            <div class="w-full bg-gray-200 rounded-full h-4 mb-8">
                <div class="progress-bar h-4 rounded-full" id="progress-bar"></div>
            </div>

            <div class="flex justify-between items-center mb-8">
                <h2 class="text-2xl font-bold text-blue-700" id="question-number">Question 1 of 10</h2>
                <div class="text-sm text-gray-600" id="question-status">Click an option to answer</div>
            </div>

            <!-- Question Text -->
            <div class="mb-10">
                <div class="question-card text-white p-8 rounded-2xl mb-8" id="question-text"></div>
                
                <!-- Question Image -->
                <div class="text-center mb-8" id="question-images"></div>
                
                <!-- Options -->
                <div class="space-y-4" id="options"></div>
            </div>

            <!-- Answer Feedback Section (Normal Mode Only) -->
            <div class="hidden mb-8 p-6 rounded-2xl" id="feedback-section">
                <div class="text-center mb-4">
                    <div class="text-6xl mb-2" id="feedback-icon"></div>
                    <div class="text-2xl font-bold mb-2" id="feedback-message">Correct!</div>
                </div>
                
                <div class="grid md:grid-cols-2 gap-4 mb-4">
                    <div class="bg-white p-4 rounded-xl border">
                        <strong>Your Answer:</strong><br>
                        <span id="user-answer-display"></span>
                    </div>
                    <div class="bg-white p-4 rounded-xl border">
                        <strong>Correct Answer:</strong><br>
                        <span class="text-green-600" id="correct-answer-display"></span>
                    </div>
                </div>
                
                <div class="bg-blue-50 p-6 rounded-xl" id="explanation-section">
                    <strong class="text-lg text-blue-800">Explanation:</strong>
                    <div id="explanation-content" class="mt-3 explanation-content"></div>
                </div>
            </div>

            <!-- Navigation -->
            <div class="flex justify-between gap-4">
                <button class="bg-gray-400 text-white px-6 py-3 rounded-xl hover:bg-gray-500 transition" 
                        onclick="window.location.href='marrow_psychiatry.html'">
                    Back to Topics
                </button>
                
                <div class="flex gap-4">
                    <button class="bg-gray-400 text-white px-6 py-3 rounded-xl disabled" id="prev-btn">
                        Previous
                    </button>
                    <button class="bg-blue-500 text-white px-6 py-3 rounded-xl hidden" id="next-btn">
                        Next
                    </button>
                    <button class="bg-green-600 text-white px-6 py-3 rounded-xl font-bold hidden" id="finish-btn">
                        Finish Quiz
                    </button>
                </div>
            </div>
        </div>
    </section>

    <!-- Test Mode Final Results -->
    <section class="container mx-auto p-6 hidden" id="test-results">
        <div class="bg-white rounded-2xl shadow-xl p-8">
            <div class="text-center mb-8">
                <h2 class="text-4xl font-bold mb-4 text-blue-700">Test Complete! üéâ</h2>
                <div class="text-6xl mb-4" id="test-grade-icon">üéØ</div>
            </div>
            
            <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-8">
                <div class="bg-green-100 p-6 rounded-2xl text-center">
                    <div class="text-4xl font-bold text-green-600" id="test-final-correct">0</div>
                    <div class="font-semibold text-green-700">Correct Answers</div>
                </div>
                <div class="bg-red-100 p-6 rounded-2xl text-center">
                    <div class="text-4xl font-bold text-red-600" id="test-final-incorrect">0</div>
                    <div class="font-semibold text-red-700">Incorrect Answers</div>
                </div>
                <div class="bg-blue-100 p-6 rounded-2xl text-center">
                    <div class="text-4xl font-bold text-blue-600" id="test-final-accuracy">0%</div>
                    <div class="font-semibold text-blue-700">Final Accuracy</div>
                </div>
            </div>

            <!-- Detailed Review -->
            <div class="mb-8">
                <h3 class="text-2xl font-bold text-gray-800 mb-4">üìã Detailed Review</h3>
                <div id="test-review-details" class="space-y-4"></div>
            </div>
            
            <div class="flex justify-center gap-4">
                <button class="bg-purple-600 text-white px-8 py-3 rounded-xl font-bold hover:bg-purple-700 transition" 
                        onclick="window.location.href='marrow_psychiatry.html'">
                    Back to Topics
                </button>
                <button class="bg-blue-600 text-white px-8 py-3 rounded-xl font-bold hover:bg-blue-700 transition" 
                        onclick="window.location.reload()">
                    Retake Quiz
                </button>
            </div>
        </div>
    </section>

    <!-- Normal Mode Final Results -->
    <section class="container mx-auto p-6 hidden" id="final-results">
        <div class="bg-white rounded-2xl shadow-xl p-8">
            <div class="text-center mb-8">
                <h2 class="text-4xl font-bold mb-4 text-blue-700">Quiz Complete! üéâ</h2>
                <div class="text-6xl mb-4" id="final-grade-icon">üéØ</div>
            </div>
            
            <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-8">
                <div class="bg-green-100 p-6 rounded-2xl text-center">
                    <div class="text-4xl font-bold text-green-600" id="final-correct">0</div>
                    <div class="font-semibold text-green-700">Correct Answers</div>
                </div>
                <div class="bg-red-100 p-6 rounded-2xl text-center">
                    <div class="text-4xl font-bold text-red-600" id="final-incorrect">0</div>
                    <div class="font-semibold text-red-700">Incorrect Answers</div>
                </div>
                <div class="bg-blue-100 p-6 rounded-2xl text-center">
                    <div class="text-4xl font-bold text-blue-600" id="final-accuracy">0%</div>
                    <div class="font-semibold text-blue-700">Final Accuracy</div>
                </div>
            </div>
            
            <div class="flex justify-center gap-4">
                <button class="bg-purple-600 text-white px-8 py-3 rounded-xl font-bold hover:bg-purple-700 transition" 
                        onclick="window.location.href='marrow_psychiatry.html'">
                    Back to Topics
                </button>
                <button class="bg-blue-600 text-white px-8 py-3 rounded-xl font-bold hover:bg-blue-700 transition" 
                        onclick="window.location.reload()">
                    Retake Quiz
                </button>
            </div>
        </div>
    </section>

    <script>
        const questions = [
  {
    "id": 113,
    "text": "Q1. Which of the following is the most common form of acute transient psychotic disorder?",
    "options": [
      {
        "label": "A",
        "text": "Acute polymorphic psychotic disorder without symptoms of schizophrenia",
        "correct": true
      },
      {
        "label": "B",
        "text": "Acute polymorphic psychotic disorder with symptoms of schizophrenia",
        "correct": false
      },
      {
        "label": "C",
        "text": "Acute schizophrenia ‚Äî like psychotic disorder",
        "correct": false
      },
      {
        "label": "D",
        "text": "Acute transient psychotic disorder, unspecified",
        "correct": false
      }
    ],
    "imageData": null,
    "explanationHTML": "<div class=\"explanation\">The most common form of acute transient psychotic disorders is polymorphic psychotic disorder without symptoms of schizophrenia (one third to a half of all cases). This is followed by polymorphic psychotic disorder with symptoms of schizophrenia. Polymorphic psychotic disorder commonly presents with marked hallucinations, delusions, and perceptual disturbances that change in type and intensity from day to day or even from hour to hour.</div><div class=\"telegram-link\"><small><a href=\"http://t.me/Friendly_neighborhood_medico_bot\"> </a></small></div>",
    "subdeck": "07_Other Psychotic Disorders",
    "deck_id": 1755954606747,
    "correctAnswer": "A. Acute polymorphic psychotic disorder without symptoms of schizophrenia"
  },
  {
    "id": 114,
    "text": "Q2. man who is distressed decides to consult a psychiatrist because he keeps having thoughts that his wife is having an affair for the past month. He believed that his wife was being unfaithful; he reported that images of fruit displayed on his wife‚Äôs social network page signaled that she was having an affair. As a result, he began placing fruit around their house in order to demonstrate his discovery. He reported no use of illicit drugs and had no other complaints. He was able to do his job. What is the most likely diagnosis?",
    "options": [
      {
        "label": "A",
        "text": "Paranoid personality disorder",
        "correct": false
      },
      {
        "label": "B",
        "text": "Acute transient psychosis",
        "correct": false
      },
      {
        "label": "C",
        "text": "Delusional disorder",
        "correct": true
      },
      {
        "label": "D",
        "text": "Schizophrenia",
        "correct": false
      }
    ],
    "imageData": null,
    "explanationHTML": "<div class=\"explanation\">The above clinical scenario of delusions of infidelity for a month not attributable to substance abuse and no impairment of function is in favor of a diagnosis of a delusional disorder. DSM-5 criteria for diagnosis of delusional disorder: * The presence of one (or more) delusions with a duration of 1 month or longer * Criteria for schizophrenia have never been met ¬¢ Functioning is not markedly impaired, and behavior is not obviously bizarre or odd ¬¢ If manic or major depressive episodes have occurred, these have been brief relative to the duration of the delusional periods * Not attributable to substance abuse, another medical condition, or another mental disorder. Delusions and hallucinations | Delusions present but no hall Inappropriate affectSocio-occ | ucinationsAppropriate affect upational dysfunctionSympto | Normal social and occupatio ms&gt;6 months nal lifeSymptoms&gt;1 month</div><div class=\"telegram-link\"><small><a href=\"http://t.me/Friendly_neighborhood_medico_bot\"> </a></small></div>",
    "subdeck": "07_Other Psychotic Disorders",
    "deck_id": 1755954606747,
    "correctAnswer": "C. Delusional disorder"
  },
  {
    "id": 115,
    "text": "Q3. Which of the following is not a risk factor for delusional disorder?",
    "options": [
      {
        "label": "A",
        "text": "Recent immigration",
        "correct": false
      },
      {
        "label": "B",
        "text": "Social isolation",
        "correct": false
      },
      {
        "label": "C",
        "text": "Family history",
        "correct": false
      },
      {
        "label": "D",
        "text": "Young age",
        "correct": true
      }
    ],
    "imageData": null,
    "explanationHTML": "<div class=\"explanation\">Advanced age is a risk factor for delusional disorders, not young age. Risk factors for delusional disorders: * Advanced age ¬¢ Sensory impairment or isolation * Personality features (e. g. unusual interpersonal sensitivity) * Family history * Social isolation * Recent immigration 105</div><div class=\"telegram-link\"><small><a href=\"http://t.me/Friendly_neighborhood_medico_bot\"> </a></small></div>",
    "subdeck": "07_Other Psychotic Disorders",
    "deck_id": 1755954606747,
    "correctAnswer": "D. Young age"
  },
  {
    "id": 116,
    "text": "Q4. 101 Mr. and Mrs. A believed that a &apos;demon&apos; told Mr. A that they would be killed imminently, so the couple bought a gun to protect themselves. While eating at a restaurant, they perceived two male diners to be laughing at them. They believed that the demon was urging them to kill the diners, and they shot the two men dead. While defending the couple in court, their lawyer mentioned a psychiatric disorder. What is the probable diagnosis?",
    "options": [
      {
        "label": "A",
        "text": "Psychosis",
        "correct": false
      },
      {
        "label": "B",
        "text": "Fregoli delusion",
        "correct": false
      },
      {
        "label": "C",
        "text": "Folie a deux",
        "correct": true
      },
      {
        "label": "D",
        "text": "Schizophrenia",
        "correct": false
      }
    ],
    "imageData": null,
    "explanationHTML": "<div class=\"explanation\">The given clinical scenario is suggestive of folie a deux. It is also known as shared delusional disorder, shared psychotic disorder, or induced psychotic disorder. In this syndrome, two individuals with a close and generally long-term relationship share the same delusional belief. Persecutory delusional beliefs are most commonly seen in this disorder. Occasionally, more than two individuals are involved ( e. g. , folie 4 trois, quatre, cinq; also folie a famille), but such cases are especially rare.</div><div class=\"telegram-link\"><small><a href=\"http://t.me/Friendly_neighborhood_medico_bot\"> </a></small></div>",
    "subdeck": "07_Other Psychotic Disorders",
    "deck_id": 1755954606747,
    "correctAnswer": "C. Folie a deux"
  },
  {
    "id": 117,
    "text": "Q5. Which of the following is not a type of somatic delusion?",
    "options": [
      {
        "label": "A",
        "text": "Delusional parasitosis",
        "correct": false
      },
      {
        "label": "B",
        "text": "Othello syndrome",
        "correct": true
      },
      {
        "label": "C",
        "text": "Bromosis",
        "correct": false
      },
      {
        "label": "D",
        "text": "Dysmorphic delusion",
        "correct": false
      }
    ],
    "imageData": null,
    "explanationHTML": "<div class=\"explanation\">Othello Syndrome is not a type of somatic delusion. It is a type of delusional jealousy, marked by suspecting a faithful partner of infidelity. Somatic delusion is diagnosed when the central themes of the delusional beliefs are of a hypochondriacal or somatic nature, where the person believes there is something medically, physically or biologically wrong with them. It includes the following: * Concerns about infestation in delusional parasitosis * Preoccupation with body features in dysmorphic delusions * Delusional concerns about body odour, referred to as bromosis</div><div class=\"telegram-link\"><small><a href=\"http://t.me/Friendly_neighborhood_medico_bot\"> </a></small></div>",
    "subdeck": "07_Other Psychotic Disorders",
    "deck_id": 1755954606747,
    "correctAnswer": "B. Othello syndrome"
  },
  {
    "id": 118,
    "text": "Q6. 24-year-old woman is obsessed with a famous Bollywood actor. She convinced herself that he is deeply in love with her and stood outside his home for hours believing that he was communicating his desire for her by waving and moving the curtains. Which of the following is false regarding this disorder?",
    "options": [
      {
        "label": "A",
        "text": "It is referred as an erotomanic delusion",
        "correct": false
      },
      {
        "label": "B",
        "text": "It is also known as psychose passionelle",
        "correct": false
      },
      {
        "label": "C",
        "text": "Patient says they fell in love with a person of higher status first",
        "correct": true
      },
      {
        "label": "D",
        "text": "Stalking behaviour may be observed",
        "correct": false
      }
    ],
    "imageData": null,
    "explanationHTML": "<div class=\"explanation\">The given clinical scenario is suggestive of De Clerambault syndrome. In this, the patients will generally describe that a person of higher status had fallen in love with them (patient) and made advances first. It is also referred to as an erotomanic type of delusional disorder or psychose passionelle. Stalking may be observed and they most often persecute their targets by unwanted communications.</div><div class=\"telegram-link\"><small><a href=\"http://t.me/Friendly_neighborhood_medico_bot\"> </a></small></div>",
    "subdeck": "07_Other Psychotic Disorders",
    "deck_id": 1755954606747,
    "correctAnswer": "C. Patient says they fell in love with a person of higher status first"
  },
  {
    "id": 119,
    "text": "Q7. young patient is admitted to your hospital with acute psychosis. He wakes up and asks for his wife even though she is present in the same room. Upon seeing her, he starts beating her, accusing her of being a nurse, masquerading as his wife. He also says that the nurse was trying to give him the wrong medication in an attempt to harm him. What is your diagnosis?",
    "options": [
      {
        "label": "A",
        "text": "102 Capgras syndrome",
        "correct": true
      },
      {
        "label": "B",
        "text": "Fregoli syndrome",
        "correct": false
      },
      {
        "label": "C",
        "text": "Delusion of subjective doubles",
        "correct": false
      },
      {
        "label": "D",
        "text": "Othello syndrome",
        "correct": false
      }
    ],
    "imageData": null,
    "explanationHTML": "<div class=\"explanation\">In the given scenario the patient thinks that the nurse (persecutor/stranger) has taken the guise of the wife (family person). This is characteristic of Capgras syndrome. Delusional misidentification syndromes include: 106 * Capgras syndrome - The delusion in Capgras syndrome is the belief that a familiar person has been replaced by an imposter. * Fregoli‚Äôs syndrome - Fregoli syndrome is a disorder in which a person holds a delusional belief that different people/strangers are in fact a single person who changes his or her appearance or is in disguise. * Syndrome of intermetamorphosis - A rare delusion that familiar persons can change themselves into other persons at will. * Doppelganger syndrome - A person feels he has his own impostor (duplicate) ‚Äî delusion of subjective doubles. * Othello syndrome - It is a rare psychiatric condition marked by morbid, pathological, or delusional jealousy.</div><div class=\"telegram-link\"><small><a href=\"http://t.me/Friendly_neighborhood_medico_bot\"> </a></small></div>",
    "subdeck": "07_Other Psychotic Disorders",
    "deck_id": 1755954606747,
    "correctAnswer": "A. 102 Capgras syndrome"
  },
  {
    "id": 120,
    "text": "Q8. 32-year-old man is brought to the psychiatric OPD with complaints that he misidentifies strangers as a single persecutor wearing different disguises. What is this syndrome called?",
    "options": [
      {
        "label": "A",
        "text": "Cotard syndrome",
        "correct": false
      },
      {
        "label": "B",
        "text": "Capgras syndrome",
        "correct": false
      },
      {
        "label": "C",
        "text": "Fregoli syndrome",
        "correct": true
      },
      {
        "label": "D",
        "text": "Magnan syndrome",
        "correct": false
      }
    ],
    "imageData": null,
    "explanationHTML": "<div class=\"explanation\">The man in the question is mistaking strangers as a familiar person/persecutor. He is under the delusion that the familiar person/stranger can assume the appearance of (or disguise themselves as) multiple strangers. This is known as Fregoli syndrome. Option A: Cotard syndrome (delire de negation/nihilistic delusion disorder) - the patient complains that they have lost all their possessions, status, their entire being, and even their internal organs. Option B: Capgras syndrome (illusion des sosies) - believes that his or her family members or other familiar people have been replaced by identical-looking imposters. Option D: Magnan syndrome - occurs in patients with cocaine addiction where they experience cocaine bugs/tactile hallucinations.</div><div class=\"telegram-link\"><small><a href=\"http://t.me/Friendly_neighborhood_medico_bot\"> </a></small></div>",
    "subdeck": "07_Other Psychotic Disorders",
    "deck_id": 1755954606747,
    "correctAnswer": "C. Fregoli syndrome"
  },
  {
    "id": 121,
    "text": "Q9. 14-year-old boy was brought to the ER by his mother after he began talking about his younger brother trying to kill him. According to him, he had killed his twin brother in utero, and now he was seeking revenge. The mother revealed that her pregnancy was a singleton. On examination, the boy was dirty, dressed inappropriately and multiple injection tracks could be seen on his arm and forearm. The first-year resident suspects substance-induced psychosis. Which of the following is not in favor of the provisional diagnosis?",
    "options": [
      {
        "label": "A",
        "text": "The patient has no insight",
        "correct": false
      },
      {
        "label": "B",
        "text": "There is no history of recurrent primary psychotic disorder",
        "correct": false
      },
      {
        "label": "C",
        "text": "The disturbance causes clinically significant distress",
        "correct": false
      },
      {
        "label": "D",
        "text": "Symptoms persist long after intoxicated/withdrawal state",
        "correct": true
      }
    ],
    "imageData": null,
    "explanationHTML": "<div class=\"explanation\">Substance-induced psychotic disorders develop during or soon after substance intoxication or withdrawal and they do not persist long after. DSM-5 and ICD-11 diagnostic criteria for substance-induced psychosis: A. Presence of one or both of the following symptoms: * Delusions. ¬¢ Hallucinations. B. There is evidence from the history, physical examination, or laboratory findings of both (1) and (2): * The symptoms in Criterion A developed during or soon after substance intoxication/withdrawal/after exposure to a medication. * The involved substance/medication is capable of producing the symptoms in Criterion A. 107 C. The disturbance is not better explained by a primary psychiatric disorder that is not substance/medication-induced. Such evidence of an independent psychotic disorder could include the following: * The symptoms preceded the onset of the substance/medication use. * The symptoms persist for a substantial period of time (e. g. , about 1 month) after the cessation of acute withdrawal or severe intoxication. * There is other evidence of an independent non-substance/medication-induced psychotic disorder (e. g. , a history of recurrent non-substance/medication-related episodes). D. The disturbance does not occur exclusively during the course of a delirium. E. The disturbance causes clinically significant distress or impairment in social, occupational, or other important areas of functioning.</div><div class=\"telegram-link\"><small><a href=\"http://t.me/Friendly_neighborhood_medico_bot\"> </a></small></div>",
    "subdeck": "07_Other Psychotic Disorders",
    "deck_id": 1755954606747,
    "correctAnswer": "D. Symptoms persist long after intoxicated/withdrawal state"
  },
  {
    "id": 122,
    "text": "Q10. homeless man who is an alcoholic was brought to the casualty by the police as they had witnessed him gouging out sections of his skin. On examination, the following findings are noted. The police said that he was a drug dealer and often resorted to experimenting with various illicit substances. What is the most likely diagnosis?",
    "options": [
      {
        "label": "A",
        "text": "103 eJ = hh Cannabis-induced psychosis",
        "correct": false
      },
      {
        "label": "B",
        "text": "Amphetamine-induced psychosis",
        "correct": false
      },
      {
        "label": "C",
        "text": "Alcohol-induced psychosis",
        "correct": false
      },
      {
        "label": "D",
        "text": "Cocaine-induced psychosis ee ee ee ee ee ee ee ee ee es ee ee ee ee en ee ee Detailed Explanations 104",
        "correct": true
      }
    ],
    "imageData": null,
    "explanationHTML": "<div class=\"explanation\">The image showing multiple gouged-out sections of skin in accessible areas, and the history of multiple drug usage, is suggestive of formication (the tactile hallucination of bugs crawling under the skin) which is commonly associated with cocaine-induced psychosis. Option A: Cannabis-induced psychotic disorder usually involves persecutory delusions, anxiety, emotional lability, and depersonalization experiences. Option B: Amphetamine-induced psychotic disorder often resembles schizophrenia. Option C: Alcohol-induced psychotic disorder often presents with auditory hallucinations after prolonged and heavy use of alcohol. 108</div><div class=\"telegram-link\"><small><a href=\"http://t.me/Friendly_neighborhood_medico_bot\"> </a></small></div>",
    "subdeck": "07_Other Psychotic Disorders",
    "deck_id": 1755954606747,
    "correctAnswer": "D. Cocaine-induced psychosis ee ee ee ee ee ee ee ee ee es ee ee ee ee en ee ee Detailed Explanations 104"
  }
];
        let currentQuestion = 0;
        let answers = [];
        let correctCount = 0;
        let incorrectCount = 0;
        let answeredQuestions = new Set();
        let isTestMode = localStorage.getItem('testMode') === 'true' || false;

        console.log('Quiz loaded with', questions.length, 'questions');
        console.log('Test mode:', isTestMode);

        // Hide stats bar if test mode is enabled
        if (isTestMode) {
            document.addEventListener('DOMContentLoaded', () => {
                document.getElementById('stats-bar').style.display = 'none';
            });
        }

        // Auto-start quiz
        startQuiz();

        function startQuiz() {
            answers = new Array(questions.length).fill(null);
            correctCount = 0;
            incorrectCount = 0;
            answeredQuestions = new Set();
            currentQuestion = 0;
            showQuestion(0);
            updateStats();
        }

        function showQuestion(index) {
            currentQuestion = index;
            const question = questions[index];

            document.getElementById('question-number').textContent = `Question ${index + 1} of ${questions.length}`;
            document.getElementById('question-text').innerHTML = question.text;
            document.getElementById('question-status').textContent = answers[index] ? 'Question answered' : 'Click an option to answer';

            const imagesContainer = document.getElementById('question-images');
            imagesContainer.innerHTML = '';

            if (question.imageData) {
                const img = document.createElement('img');
                img.src = `data:${question.imageData.mime};base64,${question.imageData.data}`;
                img.className = 'medical-image';
                img.alt = 'Medical Question Image';
                imagesContainer.appendChild(img);
            }

            const optionsContainer = document.getElementById('options');
            optionsContainer.innerHTML = '';

            question.options.forEach(option => {
                const button = document.createElement('button');
                button.className = 'option-card w-full p-6 text-left bg-white rounded-xl shadow-lg';
                button.innerHTML = `<span class="font-bold text-blue-600 mr-4">${option.label}.</span>${option.text}`;

                if (!isTestMode && answers[index] !== null) {
                    button.disabled = true;
                    if (option.correct) {
                        button.classList.add('correct');
                    } else if (answers[index] === option.label) {
                        button.classList.add('incorrect');
                    }
                } else {
                    button.onclick = () => selectAnswer(option.label);
                }

                if (answers[index] === option.label) {
                    button.classList.add('selected');
                }

                optionsContainer.appendChild(button);
            });

            // Show feedback only in normal mode and if answered
            if (!isTestMode && answers[index] !== null) {
                showFeedback(index);
            } else {
                document.getElementById('feedback-section').classList.add('hidden');
            }

            document.getElementById('prev-btn').disabled = index === 0;

            if (answers[index] !== null) {
                if (index === questions.length - 1) {
                    document.getElementById('next-btn').classList.add('hidden');
                    document.getElementById('finish-btn').classList.remove('hidden');
                } else {
                    document.getElementById('next-btn').classList.remove('hidden');
                    document.getElementById('finish-btn').classList.add('hidden');
                }
            } else {
                document.getElementById('next-btn').classList.add('hidden');
                document.getElementById('finish-btn').classList.add('hidden');
            }

            const progress = ((index + 1) / questions.length) * 100;
            document.getElementById('progress-bar').style.width = `${progress}%`;
        }

        function selectAnswer(label) {
            const question = questions[currentQuestion];
            const correctOption = question.options.find(opt => opt.correct);
            const isCorrect = correctOption && label === correctOption.label;

            if (!answeredQuestions.has(currentQuestion)) {
                answeredQuestions.add(currentQuestion);
                if (isCorrect) {
                    correctCount++;
                } else {
                    incorrectCount++;
                }
            }

            answers[currentQuestion] = label;
            updateStats();
            
            showQuestion(currentQuestion);
        }

        function showFeedback(questionIndex) {
            const question = questions[questionIndex];
            const userAnswer = answers[questionIndex];
            const correctOption = question.options.find(opt => opt.correct);
            const userOption = question.options.find(opt => opt.label === userAnswer);
            const isCorrect = correctOption && userAnswer === correctOption.label;

            const feedbackSection = document.getElementById('feedback-section');
            const feedbackIcon = document.getElementById('feedback-icon');
            const feedbackMessage = document.getElementById('feedback-message');

            if (isCorrect) {
                feedbackSection.className = 'bg-green-50 border border-green-200 mb-8 p-6 rounded-2xl';
                feedbackIcon.textContent = '‚úÖ';
                feedbackMessage.textContent = 'Correct!';
                feedbackMessage.className = 'text-2xl font-bold mb-2 text-green-700';
            } else {
                feedbackSection.className = 'bg-red-50 border border-red-200 mb-8 p-6 rounded-2xl';
                feedbackIcon.textContent = '‚ùå';
                feedbackMessage.textContent = 'Incorrect';
                feedbackMessage.className = 'text-2xl font-bold mb-2 text-red-700';
            }

            document.getElementById('user-answer-display').innerHTML = `<span class="${isCorrect ? 'text-green-600' : 'text-red-600'}">${userAnswer}. ${userOption?.text || 'Unknown'}</span>`;
            document.getElementById('correct-answer-display').textContent = question.correctAnswer;

            const explanationSection = document.getElementById('explanation-section');
            if (question.explanationHTML && question.explanationHTML.trim()) {
                document.getElementById('explanation-content').innerHTML = question.explanationHTML;
                explanationSection.classList.remove('hidden');
            } else {
                explanationSection.classList.add('hidden');
            }

            feedbackSection.classList.remove('hidden');
        }

        function updateStats() {
            const totalAnswered = correctCount + incorrectCount;
            const accuracy = totalAnswered === 0 ? 0 : Math.round((correctCount / totalAnswered) * 100);

            document.getElementById('correct-stats').textContent = correctCount;
            document.getElementById('incorrect-stats').textContent = incorrectCount;
            document.getElementById('accuracy-stats').textContent = `${accuracy}%`;
            document.getElementById('progress-stats').textContent = `${totalAnswered}/${questions.length}`;
        }

        document.getElementById('prev-btn').onclick = () => {
            if (currentQuestion > 0) {
                showQuestion(currentQuestion - 1);
            }
        };
        
        document.getElementById('next-btn').onclick = () => {
            if (currentQuestion < questions.length - 1) {
                showQuestion(currentQuestion + 1);
            }
        };
        
        document.getElementById('finish-btn').onclick = showFinalResults;

        function showFinalResults() {
            if (isTestMode) {
                showTestModeResults();
            } else {
                showNormalModeResults();
            }
        }

        function showTestModeResults() {
            const accuracy = (correctCount + incorrectCount === 0) ? 0 : Math.round((correctCount / (correctCount + incorrectCount)) * 100);

            document.getElementById('quiz-section').classList.add('hidden');
            document.getElementById('test-results').classList.remove('hidden');

            document.getElementById('test-final-correct').textContent = correctCount;
            document.getElementById('test-final-incorrect').textContent = incorrectCount;
            document.getElementById('test-final-accuracy').textContent = `${accuracy}%`;

            let gradeIcon = 'üéØ';
            if (accuracy >= 90) {
                gradeIcon = 'üèÜ';
            } else if (accuracy >= 80) {
                gradeIcon = 'üéâ';
            } else if (accuracy >= 70) {
                gradeIcon = 'üëç';
            } else if (accuracy >= 60) {
                gradeIcon = 'üìö';
            } else {
                gradeIcon = 'üí™';
            }

            document.getElementById('test-grade-icon').textContent = gradeIcon;

            // Show detailed review
            const reviewContainer = document.getElementById('test-review-details');
            reviewContainer.innerHTML = '';

            questions.forEach((question, index) => {
                const userAnswer = answers[index];
                const correctOption = question.options.find(opt => opt.correct);
                const userOption = question.options.find(opt => opt.label === userAnswer);
                const isCorrect = correctOption && userAnswer === correctOption.label;

                const reviewCard = document.createElement('div');
                reviewCard.className = `border-l-4 p-4 bg-white rounded-lg shadow-sm ${isCorrect ? 'border-green-500' : 'border-red-500'}`;
                
                reviewCard.innerHTML = `
                    <div class="flex items-center justify-between mb-2">
                        <h4 class="font-bold text-gray-800">Question ${index + 1}</h4>
                        <span class="text-2xl">${isCorrect ? '‚úÖ' : '‚ùå'}</span>
                    </div>
                    <p class="text-gray-700 mb-3">${question.text}</p>
                    <div class="grid md:grid-cols-2 gap-4">
                        <div>
                            <strong class="text-gray-600">Your Answer:</strong><br>
                            <span class="${isCorrect ? 'text-green-600' : 'text-red-600'}">${userAnswer}. ${userOption?.text || 'Not answered'}</span>
                        </div>
                        <div>
                            <strong class="text-gray-600">Correct Answer:</strong><br>
                            <span class="text-green-600">${question.correctAnswer}</span>
                        </div>
                    </div>
                    ${question.explanationHTML ? `
                        <div class="mt-3 p-3 bg-blue-50 rounded-lg">
                            <strong class="text-blue-800">Explanation:</strong>
                            <div class="mt-2 explanation-content">${question.explanationHTML}</div>
                        </div>
                    ` : ''}
                `;
                
                reviewContainer.appendChild(reviewCard);
            });
        }

        function showNormalModeResults() {
            const accuracy = (correctCount + incorrectCount === 0) ? 0 : Math.round((correctCount / (correctCount + incorrectCount)) * 100);

            document.getElementById('quiz-section').classList.add('hidden');
            document.getElementById('final-results').classList.remove('hidden');

            document.getElementById('final-correct').textContent = correctCount;
            document.getElementById('final-incorrect').textContent = incorrectCount;
            document.getElementById('final-accuracy').textContent = `${accuracy}%`;

            let gradeIcon = 'üéØ';
            if (accuracy >= 90) {
                gradeIcon = 'üèÜ';
            } else if (accuracy >= 80) {
                gradeIcon = 'üéâ';
            } else if (accuracy >= 70) {
                gradeIcon = 'üëç';
            } else if (accuracy >= 60) {
                gradeIcon = 'üìö';
            } else {
                gradeIcon = 'üí™';
            }

            document.getElementById('final-grade-icon').textContent = gradeIcon;
        }
    </script>
</body>
</html>